(function($,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("$:/plugins/oeyoews/neotw-vue3/vue.global.prod.js")):typeof define=="function"&&define.amd?define(["exports","vue"],e):($=typeof globalThis<"u"?globalThis:$||self,e($["vue3-context-menu"]={},$.Vue))})(this,function($,e){"use strict";let T=null;function Ce(){return T!==null}function ge(n){T&&ae(),T=n}function ke(n){n===T&&(T=null)}function ae(){T&&(T.closeMenu(),T=null)}const j={defaultDirection:"br",defaultMinWidth:100,defaultMaxWidth:600,defaultZindex:100,defaultAdjustPadding:{x:0,y:10}};function L(n,t){let r=n.offsetTop;return n.offsetParent!=null&&n.offsetParent!=t&&(r-=n.offsetParent.scrollTop,r+=L(n.offsetParent,t)),r}function v(n,t){let r=n.offsetLeft;return n.offsetParent!=null&&n.offsetParent!=t&&(r-=n.offsetParent.scrollLeft,r+=v(n.offsetParent,t)),r}function be(n,t,r,a){return{x:v(n,a)+t,y:L(n,a)+r}}const oe="mx-menu-default-container",Me="mx-menu-container-";let ye=0;function ce(n){const{getContainer:t,zIndex:r}=n;if(t){const h=typeof t=="function"?t():t;if(h){let C=h.getAttribute("id");return C||(C=Me+ye++,h.setAttribute("id",C)),{eleId:C,container:h,isNew:!1}}}let a=document.getElementById(oe);return a||(a=document.createElement("div"),a.setAttribute("id",oe),a.setAttribute("class","mx-menu-ghost-host fullscreen"),document.body.appendChild(a)),a.style.zIndex=(r==null?void 0:r.toString())||j.defaultZindex.toString(),{eleId:oe,container:a,isNew:!0}}function Se(n){return typeof n=="number"?`${n}px`:n}const R=e.defineComponent({props:{vnode:{type:null},data:{type:null,default:null}},setup(n){const{vnode:t,data:r}=e.toRefs(n);return()=>typeof t.value=="function"?t.value(r.value):t.value}}),Y=(n,t)=>{const r=n.__vccOpts||n;for(const[a,h]of t)r[a]=h;return r},xe={},Be={class:"mx-checked-mark","aria-hidden":"true",viewBox:"0 0 1024 1024"},we=[e.createElementVNode("path",{d:"M129.3,428.6L52,512l345,372.5l575-620.8l-69.5-75L400.4,718.2L129.3,428.6z"},null,-1)];function Ie(n,t){return e.openBlock(),e.createElementBlock("svg",Be,we)}const We=Y(xe,[["render",Ie]]),Pe={},Oe={class:"mx-right-arrow","aria-hidden":"true",viewBox:"0 0 1024 1024"},$e=[e.createElementVNode("path",{d:"M307.018 49.445c11.517 0 23.032 4.394 31.819 13.18L756.404 480.18c8.439 8.438 13.181 19.885 13.181 31.82s-4.741 23.38-13.181 31.82L338.838 961.376c-17.574 17.573-46.065 17.573-63.64-0.001-17.573-17.573-17.573-46.065 0.001-63.64L660.944 512 275.198 126.265c-17.574-17.573-17.574-46.066-0.001-63.64C283.985 53.839 295.501 49.445 307.018 49.445z"},null,-1)];function Ee(n,t){return e.openBlock(),e.createElementBlock("svg",Oe,$e)}const de=Y(Pe,[["render",Ee]]),Ne={class:"mx-item-row"},je=["xlink:href"],Re={key:1,class:"label"},_e={class:"mx-item-row"},Fe={class:"mx-shortcut"},q=e.defineComponent({__name:"ContextMenuItem",props:{disabled:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1},customRender:{type:Function,default:null},customClass:{type:String,default:""},clickHandler:{type:Function,default:null},label:{type:[String,Object,Function],default:""},icon:{type:[String,Object,Function],default:""},iconFontClass:{type:String,default:"iconfont"},checked:{type:Boolean,default:!1},shortcut:{type:String,default:""},svgIcon:{type:String,default:""},svgProps:{type:Object,default:null},preserveIconWidth:{type:Boolean,default:!0},showRightArrow:{type:Boolean,default:!1},hasChildren:{type:Boolean,default:!1},clickClose:{type:Boolean,default:!0},clickableWhenHasChildren:{type:Boolean,default:!1},rawMenuItem:{type:Object,default:void 0}},emits:["click","subMenuOpen","subMenuClose"],setup(n,{expose:t,emit:r}){const a=n,h=r,{clickHandler:C,clickClose:l,clickableWhenHasChildren:S,disabled:k,hidden:g,label:o,icon:B,iconFontClass:I,showRightArrow:P,shortcut:E,hasChildren:M}=e.toRefs(a),i=e.ref(!1),u=e.ref(!1),f=e.ref(),p=e.inject("globalHasSlot"),b=e.inject("globalRenderSlot"),_=e.inject("globalTheme"),N=e.inject("globalIconFontClass"),F=e.inject("globalMenuTransitionProps"),D=e.inject("globalClickCloseClassName"),A=e.inject("globalIgnoreClickClassName"),m=e.inject("globalCloseMenu"),y=e.inject("menuContext"),O={showSubMenu:()=>i.value?(y.markActiveMenuItem(O,!0),!0):M.value?(V(),!0):!1,isDisabledOrHidden:()=>k.value||g.value,getElement:()=>f.value,focus:()=>u.value=!0,blur:()=>u.value=!1,click:z};e.onMounted(()=>{y.isMenuItemDataCollectedFlag()?e.nextTick(()=>{let c=0;const w=y.getElement();if(w){let s=0;for(let d=0;d<w.children.length;d++){const x=w.children[d];if(x.getAttribute("data-type")==="ContextMenuItem"){if(x===f.value){c=s;break}s++}}}y.addChildMenuItem(O,c)}):y.addChildMenuItem(O)}),e.onBeforeUnmount(()=>{y.removeChildMenuItem(O)});function z(c){if(!k.value){if(c){const w=c.target;if(w.classList.contains("mx-context-no-clickable")||A&&w.classList.contains(A))return;if(D&&w.classList.contains(D)){c.stopPropagation(),m(a.rawMenuItem);return}}M.value?S.value?(typeof C.value=="function"&&C.value(c),h("click",c)):i.value||V():(typeof C.value=="function"&&C.value(c),h("click",c),l.value&&m(a.rawMenuItem))}}function V(c){u.value=!1,y.checkCloseOtherSubMenuTimeOut()||y.closeOtherSubMenu(),k.value||(y.markActiveMenuItem(O),M.value&&(c||y.markThisOpenedByKeyBoard(),y.addOpenedSubMenu(()=>{u.value=!1,i.value=!1,h("subMenuClose")}),i.value=!0,h("subMenuOpen")))}function W(){return{disabled:k.value,label:o.value,icon:B.value,iconFontClass:I.value,showRightArrow:P.value,clickClose:l.value,clickableWhenHasChildren:S.value,shortcut:E.value,theme:_,isOpen:i,hasChildren:M,onClick:z,onMouseEnter:V,closeMenu:m}}return t({showSubMenu:i,keyBoardFocusMenu:u}),(c,w)=>e.unref(g)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"mx-context-menu-item-wrapper",ref_key:"menuItemRef",ref:f,"data-type":"ContextMenuItem"},[e.unref(p)("itemRender")?(e.openBlock(),e.createBlock(e.unref(R),{key:0,vnode:()=>e.unref(b)("itemRender",W())},null,8,["vnode"])):n.customRender?(e.openBlock(),e.createBlock(e.unref(R),{key:1,vnode:n.customRender,data:W()},null,8,["vnode","data"])):(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(["mx-context-menu-item",e.unref(k)?"disabled":"",u.value?"keyboard-focus":"",n.customClass?" "+n.customClass:"",i.value?"open":""]),onClick:z,onMouseenter:V},[e.renderSlot(c.$slots,"default",{},()=>[e.createElementVNode("div",Ne,[e.createElementVNode("div",{class:e.normalizeClass(["mx-icon-placeholder",n.preserveIconWidth?"preserve-width":""])},[e.renderSlot(c.$slots,"icon",{},()=>[e.unref(p)("itemIconRender")?(e.openBlock(),e.createBlock(e.unref(R),{key:0,vnode:()=>e.unref(b)("itemIconRender",W())},null,8,["vnode"])):typeof n.svgIcon=="string"&&n.svgIcon?(e.openBlock(),e.createElementBlock("svg",e.mergeProps({key:1,class:"icon svg"},n.svgProps),[e.createElementVNode("use",{"xlink:href":n.svgIcon},null,8,je)],16)):typeof e.unref(B)!="string"?(e.openBlock(),e.createBlock(e.unref(R),{key:2,vnode:e.unref(B),data:e.unref(B)},null,8,["vnode","data"])):typeof e.unref(B)=="string"&&e.unref(B)!==""?(e.openBlock(),e.createElementBlock("i",{key:3,class:e.normalizeClass(e.unref(B)+" icon "+e.unref(I)+" "+e.unref(N))},null,2)):e.createCommentVNode("",!0)]),n.checked?e.renderSlot(c.$slots,"check",{key:0},()=>[e.unref(p)("itemCheckRender")?(e.openBlock(),e.createBlock(e.unref(R),{key:0,vnode:()=>e.unref(b)("itemCheckRender",W())},null,8,["vnode"])):e.createCommentVNode("",!0),e.createVNode(We)]):e.createCommentVNode("",!0)],2),e.renderSlot(c.$slots,"label",{},()=>[e.unref(p)("itemLabelRender")?(e.openBlock(),e.createBlock(e.unref(R),{key:0,vnode:()=>e.unref(b)("itemLabelRender",W())},null,8,["vnode"])):typeof e.unref(o)=="string"?(e.openBlock(),e.createElementBlock("span",Re,e.toDisplayString(e.unref(o)),1)):(e.openBlock(),e.createBlock(e.unref(R),{key:2,vnode:e.unref(o),data:e.unref(o)},null,8,["vnode","data"]))])]),e.createElementVNode("div",_e,[e.unref(E)?e.renderSlot(c.$slots,"shortcut",{key:0},()=>[e.unref(p)("itemShortcutRender")?(e.openBlock(),e.createBlock(e.unref(R),{key:0,vnode:()=>e.unref(b)("itemShortcutRender",W())},null,8,["vnode"])):e.createCommentVNode("",!0),e.createElementVNode("span",Fe,e.toDisplayString(e.unref(E)),1)]):e.createCommentVNode("",!0),e.unref(P)?e.renderSlot(c.$slots,"rightArrow",{key:1},()=>[e.unref(p)("itemRightArrowRender")?(e.openBlock(),e.createBlock(e.unref(R),{key:0,vnode:()=>e.unref(b)("itemRightArrowRender",W())},null,8,["vnode"])):e.createCommentVNode("",!0),e.createVNode(de)]):e.createCommentVNode("",!0)])])],34)),e.unref(F)?(e.openBlock(),e.createBlock(e.Transition,e.normalizeProps(e.mergeProps({key:3},e.unref(F))),{default:e.withCtx(()=>[i.value?e.renderSlot(c.$slots,"submenu",{key:0}):e.createCommentVNode("",!0)]),_:3},16)):i.value?e.renderSlot(c.$slots,"submenu",{key:4}):e.createCommentVNode("",!0)],512))}}),Ae=e.defineComponent({name:"ContextMenuSperator",components:{VNodeRender:R},setup(){const n=e.inject("globalHasSlot"),t=e.inject("globalRenderSlot");return{globalHasSlot:n,globalRenderSlot:t}}}),Ve={key:1,class:"mx-context-menu-item-sperator mx-context-no-clickable"};function He(n,t,r,a,h,C){const l=e.resolveComponent("VNodeRender");return n.globalHasSlot("separatorRender")?(e.openBlock(),e.createBlock(l,{key:0,vnode:()=>n.globalRenderSlot("separatorRender",{})},null,8,["vnode"])):(e.openBlock(),e.createElementBlock("div",Ve))}const J=Y(Ae,[["render",He]]),Te=e.defineComponent({name:"ContextSubMenu",components:{ContextMenuItem:q,ContextMenuSeparator:J,ContextMenuIconRight:de},props:{items:{type:Object,default:null},maxWidth:{type:[String,Number],default:0},minWidth:{type:[String,Number],default:0},adjustPosition:{type:Boolean,default:!0},direction:{type:String,default:"br"}},setup(n){const t=e.inject("menuContext"),r=e.inject("globalOptions"),a=e.inject("globalHasSlot"),h=e.inject("globalRenderSlot"),C=e.inject("globalTheme"),{zIndex:l,getParentWidth:S,getParentHeight:k}=t,{adjustPosition:g}=e.toRefs(n),o=e.ref(),B=e.ref(),I=e.ref(),P=[],E=e.inject("globalSetCurrentSubMenu"),M=[];let i=null,u=0;function f(){i&&i.blur()}function p(s,d){if(s){for(let x=d!==void 0?d:0;x<M.length;x++)if(!M[x].isDisabledOrHidden()){b(x);break}}else for(let x=d!==void 0?d:M.length-1;x>=0;x--)if(!M[x].isDisabledOrHidden()){b(x);break}}function b(s){if(i&&f(),s!==void 0&&(i=M[Math.max(0,Math.min(s,M.length-1))]),!!i&&(i.focus(),W.value)){const d=i.getElement();d&&(m.value=Math.min(Math.max(-y.value,-d.offsetTop-d.offsetHeight+w.value),0))}}function _(){E(N)}const N={isTopLevel:()=>t.getParentContext()===null,closeSelfAndActiveParent:()=>{const s=A.getParentContext();if(s){s.closeOtherSubMenu();const d=s.getSubMenuInstanceContext();if(d)return d.focusCurrentItem(),!0}return!1},closeCurrentSubMenu:()=>{var s;return(s=A.getParentContext())==null?void 0:s.closeOtherSubMenu()},moveCurrentItemFirst:()=>p(!0),moveCurrentItemLast:()=>p(!1),moveCurrentItemDown:()=>p(!0,i?M.indexOf(i)+1:0),moveCurrentItemUp:()=>p(!1,i?M.indexOf(i)-1:0),focusCurrentItem:()=>b(),openCurrentItemSubMenu:()=>i?i==null?void 0:i.showSubMenu():!1,triggerCurrentItemClick:s=>i==null?void 0:i.click(s)};let F=!1,D=!1;const A={zIndex:l+1,container:t.container,adjustPadding:r.adjustPadding||j.defaultAdjustPadding,getParentWidth:()=>{var s;return((s=o.value)==null?void 0:s.offsetWidth)||0},getParentHeight:()=>{var s;return((s=o.value)==null?void 0:s.offsetHeight)||0},getParentX:()=>c.value.x,getParentY:()=>c.value.y,getParentAbsX:()=>o.value?v(o.value,t.container):0,getParentAbsY:()=>o.value?L(o.value,t.container):0,getPositon:()=>[0,0],addOpenedSubMenu(s){P.push(s)},closeOtherSubMenu(){P.forEach(s=>s()),P.splice(0,P.length),E(N)},checkCloseOtherSubMenuTimeOut(){return u?(clearTimeout(u),u=0,!0):!1},closeOtherSubMenuWithTimeOut(){u=setTimeout(()=>{u=0,this.closeOtherSubMenu()},200)},addChildMenuItem:(s,d)=>{d===void 0?M.push(s):M.splice(d,0,s)},removeChildMenuItem:s=>{M.splice(M.indexOf(s),1)},markActiveMenuItem:(s,d=!1)=>{f(),i=s,d&&b()},markThisOpenedByKeyBoard:()=>{F=!0},isOpenedByKeyBoardFlag:()=>F?(F=!1,!0):!1,isMenuItemDataCollectedFlag:()=>D,getElement:()=>o.value||null,getParentContext:()=>t,getSubMenuInstanceContext:()=>N};e.provide("menuContext",A);const m=e.ref(0),y=e.ref(0);function O(s){s?m.value=Math.min(Math.max(m.value-50,-y.value),0):m.value=Math.min(m.value+50,0)}function z(s){s.preventDefault(),s.stopPropagation(),O(s.deltaY>0)}function V(s){r.mouseScroll&&(s.preventDefault(),s.stopPropagation(),O(s.deltaY>0))}const W=e.ref(!1),c=e.ref({x:0,y:0}),w=e.ref(0);return e.onMounted(()=>{const s=t.getPositon();c.value={x:s[0]??r.xOffset??0,y:s[1]??r.yOffset??0},E(N),e.nextTick(()=>{var x,U;const d=o.value;if(d&&B.value){const{container:H}=t,K=(S==null?void 0:S())??0,ee=(k==null?void 0:k())??0,ne=typeof t.adjustPadding=="number"?t.adjustPadding:((x=t.adjustPadding)==null?void 0:x.x)??0,te=typeof t.adjustPadding=="number"?t.adjustPadding:((U=t.adjustPadding)==null?void 0:U.y)??0,X=ee>0?te:0,en=document.documentElement.scrollHeight,nn=document.documentElement.scrollWidth,tn=Math.min(nn,H.offsetWidth),se=Math.min(en,H.offsetHeight);let re=v(d,H),ie=L(d,H);n.direction.includes("l")?c.value.x-=d.offsetWidth+ne:n.direction.includes("r")?c.value.x+=K+ne:(c.value.x+=K/2,c.value.x-=(d.offsetWidth+ne)/2),n.direction.includes("t")?c.value.y-=d.offsetHeight+te*2:n.direction.includes("b")?c.value.y-=te:c.value.y-=(d.offsetHeight+te)/2,g.value&&e.nextTick(()=>{re=v(d,H),ie=L(d,H);const on=re+d.offsetWidth-tn,pe=ie+d.offsetHeight+X*2-se;if(W.value=pe>0,y.value=d.offsetHeight-se+X*2,on>0){const G=K+d.offsetWidth-ne,Z=re;G>Z?c.value.x-=Z:c.value.x-=G}if(W.value){const G=pe,Z=ie;G>Z?c.value.y-=Z-X:c.value.y-=G-X,w.value=se-X*2}else w.value=0})}d==null||d.focus({preventScroll:!0}),t.isOpenedByKeyBoardFlag()&&p(!0),D=!0})}),{menu:o,scroll:B,options:r,zIndex:l,constOptions:j,scrollValue:m,upScrollButton:I,overflow:W,position:c,scrollHeight:y,maxHeight:w,globalHasSlot:a,globalRenderSlot:h,globalTheme:C,onScroll:O,onSubMenuBodyClick:_,onMouseWhell:V,onMouseWhellMx:z,solveNumberOrStringSize:Se}}}),rn="",Le={key:0,class:"mx-context-menu-updown placeholder"},ve={key:1,class:"mx-context-menu-updown placeholder"},De={class:"mx-context-menu-scroll",ref:"scroll"};function ze(n,t,r,a,h,C){const l=e.resolveComponent("ContextMenuSeparator"),S=e.resolveComponent("ContextSubMenu",!0),k=e.resolveComponent("ContextMenuItem"),g=e.resolveComponent("ContextMenuIconRight");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass("mx-context-menu "+(n.options.customClass?n.options.customClass:"")+" "+n.globalTheme),style:e.normalizeStyle({maxWidth:n.maxWidth?n.solveNumberOrStringSize(n.maxWidth):`${n.constOptions.defaultMaxWidth}px`,minWidth:n.minWidth?n.solveNumberOrStringSize(n.minWidth):`${n.constOptions.defaultMinWidth}px`,maxHeight:n.overflow&&n.maxHeight>0?`${n.maxHeight}px`:void 0,zIndex:n.zIndex,left:`${n.position.x}px`,top:`${n.position.y}px`}),"data-type":"ContextSubMenu",onClick:t[4]||(t[4]=(...o)=>n.onSubMenuBodyClick&&n.onSubMenuBodyClick(...o)),onWheel:t[5]||(t[5]=(...o)=>n.onMouseWhell&&n.onMouseWhell(...o))},[e.createElementVNode("div",{class:e.normalizeClass(["mx-context-menu-items"]),ref:"menu",style:e.normalizeStyle({top:`${n.scrollValue}px`})},[e.renderSlot(n.$slots,"default",{},()=>[n.overflow&&n.options.updownButtonSpaceholder?(e.openBlock(),e.createElementBlock("div",Le)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.items,(o,B)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:B},[o.hidden!==!0&&o.divided==="up"?(e.openBlock(),e.createBlock(l,{key:0})):e.createCommentVNode("",!0),o.hidden!==!0&&o.divided==="self"?(e.openBlock(),e.createBlock(l,{key:1})):(e.openBlock(),e.createBlock(k,{key:2,clickHandler:o.onClick?I=>o.onClick(I):void 0,disabled:o.disabled,hidden:o.hidden,icon:o.icon,iconFontClass:o.iconFontClass,svgIcon:o.svgIcon,svgProps:o.svgProps,label:o.label,customRender:o.customRender,customClass:o.customClass,checked:o.checked,shortcut:o.shortcut,clickClose:o.clickClose,clickableWhenHasChildren:o.clickableWhenHasChildren,preserveIconWidth:o.preserveIconWidth!==void 0?o.preserveIconWidth:n.options.preserveIconWidth,showRightArrow:o.children&&o.children.length>0,hasChildren:o.children&&o.children.length>0,rawMenuItem:o,onSubMenuOpen:o.onSubMenuOpen,onSubMenuClose:o.onSubMenuClose},e.createSlots({_:2},[o.children&&o.children.length>0?{name:"submenu",fn:e.withCtx(()=>[e.createVNode(S,{items:o.children,maxWidth:o.maxWidth,minWidth:o.minWidth,adjustPosition:o.adjustSubMenuPosition!==void 0?o.adjustSubMenuPosition:n.options.adjustPosition,direction:o.direction!==void 0?o.direction:n.options.direction},null,8,["items","maxWidth","minWidth","adjustPosition","direction"])]),key:"0"}:void 0]),1032,["clickHandler","disabled","hidden","icon","iconFontClass","svgIcon","svgProps","label","customRender","customClass","checked","shortcut","clickClose","clickableWhenHasChildren","preserveIconWidth","showRightArrow","hasChildren","rawMenuItem","onSubMenuOpen","onSubMenuClose"])),o.hidden!==!0&&(o.divided==="down"||o.divided===!0)?(e.openBlock(),e.createBlock(l,{key:3})):e.createCommentVNode("",!0)],64))),128)),n.overflow&&n.options.updownButtonSpaceholder?(e.openBlock(),e.createElementBlock("div",ve)):e.createCommentVNode("",!0)])],4),e.createElementVNode("div",De,[e.withDirectives(e.createElementVNode("div",{ref:"upScrollButton",class:e.normalizeClass("mx-context-menu-updown mx-context-no-clickable up"+(n.overflow&&n.scrollValue<0?"":" disabled")),onClick:t[0]||(t[0]=o=>n.onScroll(!1)),onWheel:t[1]||(t[1]=(...o)=>n.onMouseWhellMx&&n.onMouseWhellMx(...o))},[e.createVNode(g)],34),[[e.vShow,n.overflow]]),e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass("mx-context-menu-updown mx-context-no-clickable down"+(n.overflow&&n.scrollValue>-n.scrollHeight?"":" disabled")),onClick:t[2]||(t[2]=o=>n.onScroll(!0)),onWheel:t[3]||(t[3]=(...o)=>n.onMouseWhellMx&&n.onMouseWhellMx(...o))},[e.createVNode(g)],34),[[e.vShow,n.overflow]])],512)],38)}const Q=Y(Te,[["render",ze]]),Ke={class:"mx-menu-ghost-host"},ue=e.defineComponent({__name:"ContextSubMenuWrapper",props:{options:{type:Object,default:null},show:{type:Object,default:null},container:{type:Object,default:null},isFullScreenContainer:{type:Boolean,default:!0}},emits:["close","closeAnimFinished"],setup(n,{expose:t,emit:r}){var _,N,F,D,A;const a=n,h=r,C=e.useSlots(),{options:l,show:S,container:k}=e.toRefs(a);e.onMounted(()=>{S.value&&B()}),e.onBeforeUnmount(()=>{M()}),e.watch(S,m=>{m?B():M()});const g={closeMenu:I,isClosed:P};let o=!1;function B(){E(),ge(g)}function I(m){o=!0,h("close",m),l.value.menuTransitionProps||h("closeAnimFinished"),ke(g)}function P(){return o}function E(){setTimeout(()=>{document.addEventListener("click",p,!0),document.addEventListener("contextmenu",p,!0),document.addEventListener("scroll",f,!0),!a.isFullScreenContainer&&k.value&&k.value.addEventListener("scroll",f,!0),l.value.keyboardControl!==!1&&document.addEventListener("keydown",u)},50)}function M(){document.removeEventListener("contextmenu",p,!0),document.removeEventListener("click",p,!0),document.removeEventListener("scroll",f,!0),!a.isFullScreenContainer&&k.value&&k.value.removeEventListener("scroll",f,!0),l.value.keyboardControl!==!1&&document.removeEventListener("keydown",u)}const i=e.ref();e.provide("globalSetCurrentSubMenu",m=>i.value=m);function u(m){var O,z,V,W,c,w,s,d,x,U,H,K,ee;let y=!0;switch(m.key){case"Escape":{((O=i.value)==null?void 0:O.isTopLevel())===!1?(z=i.value)==null||z.closeCurrentSubMenu():I();break}case"ArrowDown":(V=i.value)==null||V.moveCurrentItemDown();break;case"ArrowUp":(W=i.value)==null||W.moveCurrentItemUp();break;case"Home":(c=i.value)==null||c.moveCurrentItemFirst();break;case"End":(w=i.value)==null||w.moveCurrentItemLast();break;case"ArrowLeft":{(s=i.value)!=null&&s.closeSelfAndActiveParent()||(x=(d=l.value).onKeyFocusMoveLeft)==null||x.call(d);break}case"ArrowRight":(U=i.value)!=null&&U.openCurrentItemSubMenu()||(K=(H=l.value).onKeyFocusMoveRight)==null||K.call(H);break;case"Enter":(ee=i.value)==null||ee.triggerCurrentItemClick(m);break;default:y=!1;break}y&&i.value&&(m.stopPropagation(),m.preventDefault())}function f(){l.value.closeWhenScroll!==!1&&I()}function p(m){b(m.target)}function b(m){for(;m;){if(m.classList&&m.classList.contains("mx-menu-host"))return;m=m.parentNode}l.value.clickCloseOnOutside!==!1&&(M(),I())}return e.provide("globalOptions",l.value),e.provide("globalCloseMenu",I),e.provide("globalTheme",((_=l.value)==null?void 0:_.theme)||"light"),e.provide("globalIsFullScreenContainer",a.isFullScreenContainer),e.provide("globalClickCloseClassName",(N=l.value)==null?void 0:N.clickCloseClassName),e.provide("globalIgnoreClickClassName",(F=l.value)==null?void 0:F.ignoreClickClassName),e.provide("globalIconFontClass",((D=l.value)==null?void 0:D.iconFontClass)||"iconfont"),e.provide("globalMenuTransitionProps",(A=l.value)==null?void 0:A.menuTransitionProps),e.provide("globalHasSlot",m=>C[m]!==void 0),e.provide("globalRenderSlot",(m,y)=>e.renderSlot(C,m,{...y},()=>[e.h("span","Render slot failed")],!1)),e.provide("menuContext",{zIndex:l.value.zIndex||j.defaultZindex,container:k.value,adjustPadding:{x:0,y:0},getParentAbsY:()=>l.value.x,getParentAbsX:()=>l.value.y,getParentX:()=>0,getParentY:()=>0,getParentWidth:()=>0,getParentHeight:()=>0,getPositon:()=>[l.value.x,l.value.y],closeOtherSubMenuWithTimeOut:()=>{},checkCloseOtherSubMenuTimeOut:()=>!1,addOpenedSubMenu:()=>{},closeOtherSubMenu:()=>{},getParentContext:()=>null,getSubMenuInstanceContext:()=>null,getElement:()=>null,addChildMenuItem:()=>{},removeChildMenuItem:()=>{},markActiveMenuItem:()=>{},markThisOpenedByKeyBoard:()=>{},isOpenedByKeyBoardFlag:()=>!1,isMenuItemDataCollectedFlag:()=>!1}),t(g),(m,y)=>(e.openBlock(),e.createElementBlock("div",Ke,[e.unref(l).menuTransitionProps?(e.openBlock(),e.createBlock(e.Transition,e.mergeProps({key:0,appear:""},e.unref(l).menuTransitionProps,{onAfterLeave:y[0]||(y[0]=O=>h("closeAnimFinished"))}),{default:e.withCtx(()=>[e.unref(S)?(e.openBlock(),e.createBlock(Q,{key:0,class:"mx-menu-host",items:e.unref(l).items,adjustPosition:e.unref(l).adjustPosition,maxWidth:e.unref(l).maxWidth||e.unref(j).defaultMaxWidth,minWidth:e.unref(l).minWidth||e.unref(j).defaultMinWidth,direction:e.unref(l).direction||e.unref(j).defaultDirection},{default:e.withCtx(()=>[e.renderSlot(m.$slots,"default")]),_:3},8,["items","adjustPosition","maxWidth","minWidth","direction"])):e.createCommentVNode("",!0)]),_:3},16)):e.unref(S)?(e.openBlock(),e.createBlock(Q,{key:1,class:"mx-menu-host",items:e.unref(l).items,adjustPosition:e.unref(l).adjustPosition,maxWidth:e.unref(l).maxWidth||e.unref(j).defaultMaxWidth,minWidth:e.unref(l).minWidth||e.unref(j).defaultMinWidth,direction:e.unref(l).direction||e.unref(j).defaultDirection},{default:e.withCtx(()=>[e.renderSlot(m.$slots,"default")]),_:3},8,["items","adjustPosition","maxWidth","minWidth","direction"])):e.createCommentVNode("",!0)]))}}),an="",fe=e.defineComponent({name:"ContextMenu",emits:["update:show","close"],props:{options:{type:Object,default:null},show:{type:Boolean,default:!1}},setup(n,t){const{options:r,show:a}=e.toRefs(n);return t.expose({closeMenu:()=>t.emit("update:show",!1),isClosed:()=>!a.value}),()=>{const{isNew:h,container:C,eleId:l}=ce(r.value);return[e.h(e.Teleport,{to:`#${l}`},[e.h(ue,{options:r,show:a,container:C,isFullScreenContainer:!h,onClose:S=>{var k,g;t.emit("update:show",!1),t.emit("close"),(g=(k=r.value).onClose)==null||g.call(k,S)}},t.slots)])]}}}),me=e.defineComponent({name:"ContextMenuGroup",props:{disabled:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1},clickHandler:{type:Function,default:null},label:{type:String,default:""},icon:{type:String,default:""},iconFontClass:{type:String,default:"iconfont"},checked:{type:Boolean,default:!1},shortcut:{type:String,default:""},svgIcon:{type:String,default:""},svgProps:{type:Object,default:null},preserveIconWidth:{type:Boolean,default:!0},showRightArrow:{type:Boolean,default:!1},clickClose:{type:Boolean,default:!0},adjustSubMenuPosition:{type:Boolean,default:void 0},maxWidth:{type:[String,Number],default:0},minWidth:{type:[String,Number],default:0}},setup(n,t){const r=e.inject("globalOptions"),{adjustSubMenuPosition:a,maxWidth:h,minWidth:C}=e.toRefs(n),l=typeof a.value<"u"?a.value:r.adjustPosition;return()=>e.h(q,{...n,showRightArrow:!0,maxWidth:void 0,minWidth:void 0,adjustSubMenuPosition:void 0,hasChildren:typeof t.slots.default!==void 0},t.slots.default?{submenu:()=>e.h(Q,{maxWidth:h.value,minWidth:C.value,adjustPosition:l},{default:t.slots.default})}:void 0)}});function Ye(n,t,r,a){const h=e.ref(!0),C=e.h(ue,{options:n,show:h,container:t,isFullScreenContainer:!r,onCloseAnimFinished:()=>{e.render(null,t)},onClose:l=>{var S;(S=n.onClose)==null||S.call(n,l),h.value=!1}},a);return e.render(C,t),C.component}function he(n,t){const r=ce(n);return Ye(n,r.container,r.isNew,t).exposed}const le={install(n){n.config.globalProperties.$contextmenu=he,n.component("ContextMenu",fe),n.component("ContextMenuItem",q),n.component("ContextMenuGroup",me),n.component("ContextMenuSperator",J),n.component("ContextMenuSeparator",J),n.component("ContextSubMenu",Q)},showContextMenu(n,t){return he(n,t)},isAnyContextMenuOpen(){return Ce()},closeContextMenu:ae,transformMenuPosition:be},Ue={},Xe={class:"mx-menu-bar-icon-menu",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200"},Ge=[e.createElementVNode("path",{d:"M133.310936 296.552327l757.206115 0c19.781623 0 35.950949-16.169326 35.950949-35.950949 0-19.781623-15.997312-35.950949-35.950949-35.950949L133.310936 224.650428c-19.781623 0-35.950949 16.169326-35.950949 35.950949C97.359987 280.383 113.529313 296.552327 133.310936 296.552327z"},null,-1),e.createElementVNode("path",{d:"M890.51705 476.135058 133.310936 476.135058c-19.781623 0-35.950949 16.169326-35.950949 35.950949 0 19.781623 16.169326 35.950949 35.950949 35.950949l757.206115 0c19.781623 0 35.950949-16.169326 35.950949-35.950949C926.467999 492.304384 910.298673 476.135058 890.51705 476.135058z"},null,-1),e.createElementVNode("path",{d:"M890.51705 727.447673 133.310936 727.447673c-19.781623 0-35.950949 15.997312-35.950949 35.950949s16.169326 35.950949 35.950949 35.950949l757.206115 0c19.781623 0 35.950949-15.997312 35.950949-35.950949S910.298673 727.447673 890.51705 727.447673z"},null,-1)];function Ze(n,t){return e.openBlock(),e.createElementBlock("svg",Xe,Ge)}const qe=Y(Ue,[["render",Ze]]),Je=["onClick","onMouseenter"],Qe=e.defineComponent({__name:"MenuBar",props:{options:{type:Object,default:null}},setup(n){const t=n,r=e.ref(),a=e.ref(!1),h=e.ref([]),C=e.ref(null);function l(){a.value=!0}function S(){a.value=!1}e.onMounted(()=>{h.value=t.options.items||[]}),e.watch(()=>t.options,()=>{h.value=t.options.items||[]});let k=null,g=-1;function o(){g<h.value.length-1?g++:g=0,P(g,h.value[g])}function B(){g>0?g--:g=h.value.length-1,P(g,h.value[g])}function I(u){const f=t.options.barPopDirection??"bl";let p=0,b=0;return f.startsWith("b")?b=L(u)+u.offsetHeight:f.startsWith("t")?b=L(u):b=L(u)+u.offsetHeight/2,f.endsWith("l")?p=v(u):f.startsWith("r")?p=v(u)+u.offsetWidth:p=v(u)+u.offsetWidth/2,{x:p,y:b}}function P(u,f){var b;if(g=u,!f.children)return;k&&(k.closeMenu(),k=null,a.value=!0),C.value=f;const p=(b=r.value)==null?void 0:b.children[u];if(p){const{x:_,y:N}=I(p);k=le.showContextMenu({...t.options,items:f.children,x:_,y:N,onKeyFocusMoveLeft(){B()},onKeyFocusMoveRight(){o()},onClose(){C.value==f&&(a.value=!1,C.value=null)}})}}function E(){g=0;const u=r.value;if(u){const{x:f,y:p}=I(u);k=le.showContextMenu({...t.options,x:f,y:p})}}function M(u,f){f?(a.value=!0,P(u,f),f.onClick&&(f.clickableWhenHasChildren===!0&&f.children&&f.children.length>0||!f.children||f.children.length===0)&&f.onClick()):E()}function i(u,f){a.value&&P(u,f)}return(u,f)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["mx-menu-bar",n.options.theme??"",n.options.mini?"mini":""]),onFocus:l,onBlur:S},[e.renderSlot(u.$slots,"prefix"),n.options.mini?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"menuBarContent",ref:r,class:"mx-menu-bar-content"},[e.createElementVNode("div",{class:"mx-menu-bar-item",onClick:f[0]||(f[0]=p=>M(0,null))},[e.createVNode(qe)])],512)):(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"menuBarContent",ref:r,class:"mx-menu-bar-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,(p,b)=>(e.openBlock(),e.createElementBlock("div",{key:b,class:e.normalizeClass(["mx-menu-bar-item",p==C.value?"active":""]),onClick:_=>M(b,p),onMouseenter:_=>i(b,p)},e.toDisplayString(p.label),43,Je))),128))],512)),e.renderSlot(u.$slots,"suffix")],34))}}),fn="";$.ContextMenu=fe,$.ContextMenuGroup=me,$.ContextMenuItem=q,$.ContextMenuSeparator=J,$.MenuBar=Qe,$.default=le,Object.defineProperties($,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
