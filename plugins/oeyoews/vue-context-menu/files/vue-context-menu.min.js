(function(N,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("$:/plugins/oeyoews/neotw-vue3/vue.global.prod.js")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(N=typeof globalThis<"u"?globalThis:N||self,e(N["vue3-context-menu"]={},N.Vue))})(this,function(N,e){"use strict";let V=null;function ke(){return V!==null}function ge(n){V&&ie(),V=n}function re(n){n===V&&(V=null)}function ie(){V&&(V.closeMenu(),V=null)}const R={defaultDirection:"br",defaultMinWidth:100,defaultMaxWidth:600,defaultZindex:100,defaultZoom:1,defaultAdjustPadding:{x:0,y:10}};function H(n,t){let s=n.offsetTop;return n.offsetParent!=null&&n.offsetParent!=t&&(s-=n.offsetParent.scrollTop,s+=H(n.offsetParent,t)),s}function L(n,t){let s=n.offsetLeft;return n.offsetParent!=null&&n.offsetParent!=t&&(s-=n.offsetParent.scrollLeft,s+=L(n.offsetParent,t)),s}function be(n,t,s,a){return{x:L(n,a)+t,y:H(n,a)+s}}const ee="mx-menu-default-container",Me="mx-menu-container-";let ye=0;function ae(n){const{getContainer:t,zIndex:s}=n;if(t){const h=typeof t=="function"?t():t;if(h){let C=h.getAttribute("id");return C||(C=Me+ye++,h.setAttribute("id",C)),{eleId:C,container:h,isNew:!1}}}let a=document.getElementById(ee);return a||(a=document.createElement("div"),a.setAttribute("id",ee),a.setAttribute("class","mx-menu-ghost-host fullscreen"),document.body.appendChild(a)),a.style.zIndex=(s==null?void 0:s.toString())||R.defaultZindex.toString(),{eleId:ee,container:a,isNew:!0}}function Se(n){return typeof n=="number"?`${n}px`:n}const v=e.defineComponent({props:{vnode:{type:null},data:{type:null,default:null}},setup(n){const{vnode:t,data:s}=e.toRefs(n);return()=>typeof t.value=="function"?t.value(s.value):t.value}}),K=(n,t)=>{const s=n.__vccOpts||n;for(const[a,h]of t)s[a]=h;return s},xe={},Be={class:"mx-checked-mark","aria-hidden":"true",viewBox:"0 0 1024 1024"},we=[e.createElementVNode("path",{d:"M129.3,428.6L52,512l345,372.5l575-620.8l-69.5-75L400.4,718.2L129.3,428.6z"},null,-1)];function Ie(n,t){return e.openBlock(),e.createElementBlock("svg",Be,we)}const We=K(xe,[["render",Ie]]),Pe={},Oe={class:"mx-right-arrow","aria-hidden":"true",viewBox:"0 0 1024 1024"},$e=[e.createElementVNode("path",{d:"M307.018 49.445c11.517 0 23.032 4.394 31.819 13.18L756.404 480.18c8.439 8.438 13.181 19.885 13.181 31.82s-4.741 23.38-13.181 31.82L338.838 961.376c-17.574 17.573-46.065 17.573-63.64-0.001-17.573-17.573-17.573-46.065 0.001-63.64L660.944 512 275.198 126.265c-17.574-17.573-17.574-46.066-0.001-63.64C283.985 53.839 295.501 49.445 307.018 49.445z"},null,-1)];function Ee(n,t){return e.openBlock(),e.createElementBlock("svg",Oe,$e)}const ce=K(Pe,[["render",Ee]]),Ne={class:"mx-item-row"},Re=["xlink:href"],je={key:1,class:"label"},_e={class:"mx-item-row"},Ae={class:"mx-shortcut"},X=e.defineComponent({__name:"ContextMenuItem",props:{disabled:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1},customRender:{type:Function,default:null},customClass:{type:String,default:""},clickHandler:{type:Function,default:null},label:{type:[String,Object,Function],default:""},icon:{type:[String,Object,Function],default:""},iconFontClass:{type:String,default:"iconfont"},checked:{type:Boolean,default:!1},shortcut:{type:String,default:""},svgIcon:{type:String,default:""},svgProps:{type:Object,default:null},preserveIconWidth:{type:Boolean,default:!0},showRightArrow:{type:Boolean,default:!1},hasChildren:{type:Boolean,default:!1},clickClose:{type:Boolean,default:!0},clickableWhenHasChildren:{type:Boolean,default:!1},rawMenuItem:{type:Object,default:void 0}},emits:["click","subMenuOpen","subMenuClose"],setup(n,{expose:t,emit:s}){const a=n,h=s,{clickHandler:C,clickClose:l,clickableWhenHasChildren:x,disabled:p,hidden:k,label:o,icon:w,iconFontClass:I,showRightArrow:P,shortcut:_,hasChildren:M}=e.toRefs(a),i=e.ref(!1),c=e.ref(!1),u=e.ref(),m=e.inject("globalOptions"),b=e.inject("globalHasSlot"),d=e.inject("globalRenderSlot"),B=e.inject("globalCloseMenu"),y=e.inject("menuContext"),O={showSubMenu:()=>i.value?(y.markActiveMenuItem(O,!0),!0):M.value?($(),!0):!1,isDisabledOrHidden:()=>p.value||k.value,getElement:()=>u.value,focus:()=>c.value=!0,blur:()=>c.value=!1,click:F};e.onMounted(()=>{y.isMenuItemDataCollectedFlag()?e.nextTick(()=>{let g=0;const E=y.getElement();if(E){let T=0;for(let A=0;A<E.children.length;A++){const S=E.children[A];if(S.getAttribute("data-type")==="ContextMenuItem"){if(S===u.value){g=T;break}T++}}}y.addChildMenuItem(O,g)}):y.addChildMenuItem(O)}),e.onBeforeUnmount(()=>{y.removeChildMenuItem(O)});function F(g){if(!p.value){if(g){const E=g.target;if(E.classList.contains("mx-context-no-clickable")||m.value.ignoreClickClassName&&E.classList.contains(m.value.ignoreClickClassName))return;if(m.value.clickCloseClassName&&E.classList.contains(m.value.clickCloseClassName)){g.stopPropagation(),B(a.rawMenuItem);return}}M.value?x.value?(typeof C.value=="function"&&C.value(g),h("click",g)):i.value||$():(typeof C.value=="function"&&C.value(g),h("click",g),l.value&&B(a.rawMenuItem))}}function $(g){c.value=!1,y.checkCloseOtherSubMenuTimeOut()||y.closeOtherSubMenu(),p.value||(y.markActiveMenuItem(O),M.value&&(g||y.markThisOpenedByKeyBoard(),y.addOpenedSubMenu(()=>{c.value=!1,i.value=!1,h("subMenuClose")}),i.value=!0,h("subMenuOpen")))}function W(){return{disabled:p.value,label:o.value,icon:w.value,iconFontClass:I.value,showRightArrow:P.value,clickClose:l.value,clickableWhenHasChildren:x.value,shortcut:_.value,theme:m.value.theme,isOpen:i,hasChildren:M,onClick:F,onMouseEnter:$,closeMenu:B}}return t({showSubMenu:i,keyBoardFocusMenu:c}),(g,E)=>e.unref(k)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"mx-context-menu-item-wrapper",ref_key:"menuItemRef",ref:u,"data-type":"ContextMenuItem"},[e.unref(b)("itemRender")?(e.openBlock(),e.createBlock(e.unref(v),{key:0,vnode:()=>e.unref(d)("itemRender",W())},null,8,["vnode"])):n.customRender?(e.openBlock(),e.createBlock(e.unref(v),{key:1,vnode:n.customRender,data:W()},null,8,["vnode","data"])):(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(["mx-context-menu-item",e.unref(p)?"disabled":"",c.value?"keyboard-focus":"",n.customClass?" "+n.customClass:"",i.value?"open":""]),onClick:F,onMouseenter:$},[e.renderSlot(g.$slots,"default",{},()=>[e.createElementVNode("div",Ne,[e.createElementVNode("div",{class:e.normalizeClass(["mx-icon-placeholder",n.preserveIconWidth?"preserve-width":""])},[e.renderSlot(g.$slots,"icon",{},()=>[e.unref(b)("itemIconRender")?(e.openBlock(),e.createBlock(e.unref(v),{key:0,vnode:()=>e.unref(d)("itemIconRender",W())},null,8,["vnode"])):typeof n.svgIcon=="string"&&n.svgIcon?(e.openBlock(),e.createElementBlock("svg",e.mergeProps({key:1,class:"icon svg"},n.svgProps),[e.createElementVNode("use",{"xlink:href":n.svgIcon},null,8,Re)],16)):typeof e.unref(w)!="string"?(e.openBlock(),e.createBlock(e.unref(v),{key:2,vnode:e.unref(w),data:e.unref(w)},null,8,["vnode","data"])):typeof e.unref(w)=="string"&&e.unref(w)!==""?(e.openBlock(),e.createElementBlock("i",{key:3,class:e.normalizeClass(e.unref(w)+" icon "+e.unref(I)+" "+e.unref(m).iconFontClass)},null,2)):e.createCommentVNode("",!0)]),n.checked?e.renderSlot(g.$slots,"check",{key:0},()=>[e.unref(b)("itemCheckRender")?(e.openBlock(),e.createBlock(e.unref(v),{key:0,vnode:()=>e.unref(d)("itemCheckRender",W())},null,8,["vnode"])):e.createCommentVNode("",!0),e.createVNode(We)]):e.createCommentVNode("",!0)],2),e.renderSlot(g.$slots,"label",{},()=>[e.unref(b)("itemLabelRender")?(e.openBlock(),e.createBlock(e.unref(v),{key:0,vnode:()=>e.unref(d)("itemLabelRender",W())},null,8,["vnode"])):typeof e.unref(o)=="string"?(e.openBlock(),e.createElementBlock("span",je,e.toDisplayString(e.unref(o)),1)):(e.openBlock(),e.createBlock(e.unref(v),{key:2,vnode:e.unref(o),data:e.unref(o)},null,8,["vnode","data"]))])]),e.createElementVNode("div",_e,[e.unref(_)?e.renderSlot(g.$slots,"shortcut",{key:0},()=>[e.unref(b)("itemShortcutRender")?(e.openBlock(),e.createBlock(e.unref(v),{key:0,vnode:()=>e.unref(d)("itemShortcutRender",W())},null,8,["vnode"])):e.createCommentVNode("",!0),e.createElementVNode("span",Ae,e.toDisplayString(e.unref(_)),1)]):e.createCommentVNode("",!0),e.unref(P)?e.renderSlot(g.$slots,"rightArrow",{key:1},()=>[e.unref(b)("itemRightArrowRender")?(e.openBlock(),e.createBlock(e.unref(v),{key:0,vnode:()=>e.unref(d)("itemRightArrowRender",W())},null,8,["vnode"])):e.createCommentVNode("",!0),e.createVNode(ce)]):e.createCommentVNode("",!0)])])],34)),e.unref(m).menuTransitionProps?(e.openBlock(),e.createBlock(e.Transition,e.normalizeProps(e.mergeProps({key:3},e.unref(m).menuTransitionProps)),{default:e.withCtx(()=>[i.value?e.renderSlot(g.$slots,"submenu",{key:0}):e.createCommentVNode("",!0)]),_:3},16)):i.value?e.renderSlot(g.$slots,"submenu",{key:4}):e.createCommentVNode("",!0)],512))}}),ve=e.defineComponent({name:"ContextMenuSperator",components:{VNodeRender:v},setup(){const n=e.inject("globalHasSlot"),t=e.inject("globalRenderSlot");return{globalHasSlot:n,globalRenderSlot:t}}}),Fe={key:1,class:"mx-context-menu-item-sperator mx-context-no-clickable"};function Ve(n,t,s,a,h,C){const l=e.resolveComponent("VNodeRender");return n.globalHasSlot("separatorRender")?(e.openBlock(),e.createBlock(l,{key:0,vnode:()=>n.globalRenderSlot("separatorRender",{})},null,8,["vnode"])):(e.openBlock(),e.createElementBlock("div",Fe))}const G=K(ve,[["render",Ve]]),He=e.defineComponent({name:"ContextSubMenu",components:{ContextMenuItem:X,ContextMenuSeparator:G,ContextMenuIconRight:ce},props:{items:{type:Object,default:null},maxWidth:{type:[String,Number],default:0},minWidth:{type:[String,Number],default:0},adjustPosition:{type:Boolean,default:!0},direction:{type:String,default:"br"}},setup(n){const t=e.inject("menuContext"),s=e.inject("globalOptions"),a=e.inject("globalHasSlot"),h=e.inject("globalRenderSlot"),{zIndex:C,getParentWidth:l,getParentHeight:x,getZoom:p}=t,{adjustPosition:k}=e.toRefs(n),o=e.ref(),w=e.ref(),I=e.ref(),P=[],_=e.inject("globalSetCurrentSubMenu"),M=[];let i=null,c=0;function u(){i&&i.blur()}function m(r,f){if(r){for(let j=f!==void 0?f:0;j<M.length;j++)if(!M[j].isDisabledOrHidden()){b(j);break}}else for(let j=f!==void 0?f:M.length-1;j>=0;j--)if(!M[j].isDisabledOrHidden()){b(j);break}}function b(r){if(i&&u(),r!==void 0&&(i=M[Math.max(0,Math.min(r,M.length-1))]),!!i&&(i.focus(),A.value)){const f=i.getElement();f&&($.value=Math.min(Math.max(-W.value,-f.offsetTop-f.offsetHeight+D.value),0))}}function d(){_(B)}const B={isTopLevel:()=>t.getParentContext()===null,closeSelfAndActiveParent:()=>{const r=F.getParentContext();if(r){r.closeOtherSubMenu();const f=r.getSubMenuInstanceContext();if(f)return f.focusCurrentItem(),!0}return!1},closeCurrentSubMenu:()=>{var r;return(r=F.getParentContext())==null?void 0:r.closeOtherSubMenu()},moveCurrentItemFirst:()=>m(!0),moveCurrentItemLast:()=>m(!1),moveCurrentItemDown:()=>m(!0,i?M.indexOf(i)+1:0),moveCurrentItemUp:()=>m(!1,i?M.indexOf(i)-1:0),focusCurrentItem:()=>b(),openCurrentItemSubMenu:()=>i?i==null?void 0:i.showSubMenu():!1,triggerCurrentItemClick:r=>i==null?void 0:i.click(r)};let y=!1,O=!1;const F={zIndex:C+1,container:t.container,adjustPadding:s.value.adjustPadding||R.defaultAdjustPadding,getParentWidth:()=>{var r;return((r=o.value)==null?void 0:r.offsetWidth)||0},getParentHeight:()=>{var r;return((r=o.value)==null?void 0:r.offsetHeight)||0},getParentX:()=>S.value.x,getParentY:()=>S.value.y,getParentAbsX:()=>o.value?L(o.value,t.container):0,getParentAbsY:()=>o.value?H(o.value,t.container):0,getPositon:()=>[0,0],getZoom:()=>s.value.zoom||R.defaultZoom,addOpenedSubMenu(r){P.push(r)},closeOtherSubMenu(){P.forEach(r=>r()),P.splice(0,P.length),_(B)},checkCloseOtherSubMenuTimeOut(){return c?(clearTimeout(c),c=0,!0):!1},closeOtherSubMenuWithTimeOut(){c=setTimeout(()=>{c=0,this.closeOtherSubMenu()},200)},addChildMenuItem:(r,f)=>{f===void 0?M.push(r):M.splice(f,0,r)},removeChildMenuItem:r=>{M.splice(M.indexOf(r),1)},markActiveMenuItem:(r,f=!1)=>{u(),i=r,f&&b()},markThisOpenedByKeyBoard:()=>{y=!0},isOpenedByKeyBoardFlag:()=>y?(y=!1,!0):!1,isMenuItemDataCollectedFlag:()=>O,getElement:()=>o.value||null,getParentContext:()=>t,getSubMenuInstanceContext:()=>B};e.provide("menuContext",F);const $=e.ref(0),W=e.ref(0);function g(r){r?$.value=Math.min(Math.max($.value-50,-W.value),0):$.value=Math.min($.value+50,0)}function E(r){r.preventDefault(),r.stopPropagation(),g(r.deltaY>0)}function T(r){s.value.mouseScroll&&(r.preventDefault(),r.stopPropagation(),g(r.deltaY>0))}const A=e.ref(!1),S=e.ref({x:0,y:0}),D=e.ref(0);return e.onMounted(()=>{const r=t.getPositon();S.value={x:(r[0]??s.value.xOffset??0)/p(),y:(r[1]??s.value.yOffset??0)/p()},_(B),e.nextTick(()=>{var j,he;const f=o.value;if(f&&w.value){const{container:z}=t,te=(l==null?void 0:l())??0,pe=(x==null?void 0:x())??0,J=typeof t.adjustPadding=="number"?t.adjustPadding:((j=t.adjustPadding)==null?void 0:j.x)??0,Q=typeof t.adjustPadding=="number"?t.adjustPadding:((he=t.adjustPadding)==null?void 0:he.y)??0,Y=pe>0?Q:0,en=document.documentElement.scrollHeight/p(),nn=document.documentElement.scrollWidth/p(),tn=Math.min(nn,z.offsetWidth),oe=Math.min(en,z.offsetHeight);let le=L(f,z),se=H(f,z);n.direction.includes("l")?S.value.x-=f.offsetWidth+J:n.direction.includes("r")?S.value.x+=te+J:(S.value.x+=te/2,S.value.x-=(f.offsetWidth+J)/2),n.direction.includes("t")?S.value.y-=(f.offsetHeight+Q*2)/p():n.direction.includes("b")?S.value.y-=Q/p():(S.value.y+=pe/2/p(),S.value.y-=(f.offsetHeight+Q)/2/p()),k.value&&e.nextTick(()=>{le=L(f,z),se=H(f,z);const on=le+f.offsetWidth-tn,Ce=se+f.offsetHeight+Y*2-oe;if(A.value=Ce>0,W.value=f.offsetHeight-oe+Y*2,on>0){const Z=te+f.offsetWidth-J,U=le;Z>U?S.value.x-=U:S.value.x-=Z}if(A.value){const Z=Ce,U=se;Z>U?S.value.y-=U-Y:S.value.y-=Z-Y,D.value=oe-Y*2}else D.value=0})}f==null||f.focus({preventScroll:!0}),t.isOpenedByKeyBoardFlag()&&m(!0),O=!0})}),{menu:o,scroll:w,options:s,zIndex:C,constOptions:R,scrollValue:$,upScrollButton:I,overflow:A,position:S,scrollHeight:W,maxHeight:D,globalHasSlot:a,globalRenderSlot:h,onScroll:g,onSubMenuBodyClick:d,onMouseWhell:T,onMouseWhellMx:E,solveNumberOrStringSize:Se}}}),rn="",Le={key:0,class:"mx-context-menu-updown placeholder"},Te={key:1,class:"mx-context-menu-updown placeholder"},De={class:"mx-context-menu-scroll",ref:"scroll"};function ze(n,t,s,a,h,C){const l=e.resolveComponent("ContextMenuSeparator"),x=e.resolveComponent("ContextSubMenu",!0),p=e.resolveComponent("ContextMenuItem"),k=e.resolveComponent("ContextMenuIconRight");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["mx-context-menu",n.options.customClass?n.options.customClass:"",n.options.theme??""]),style:e.normalizeStyle({maxWidth:n.maxWidth?n.solveNumberOrStringSize(n.maxWidth):`${n.constOptions.defaultMaxWidth}px`,minWidth:n.minWidth?n.solveNumberOrStringSize(n.minWidth):`${n.constOptions.defaultMinWidth}px`,maxHeight:n.overflow&&n.maxHeight>0?`${n.maxHeight}px`:void 0,zIndex:n.zIndex,left:`${n.position.x}px`,top:`${n.position.y}px`}),"data-type":"ContextSubMenu",onClick:t[4]||(t[4]=(...o)=>n.onSubMenuBodyClick&&n.onSubMenuBodyClick(...o)),onWheel:t[5]||(t[5]=(...o)=>n.onMouseWhell&&n.onMouseWhell(...o))},[e.createElementVNode("div",{class:e.normalizeClass(["mx-context-menu-items"]),ref:"menu",style:e.normalizeStyle({top:`${n.scrollValue}px`})},[e.renderSlot(n.$slots,"default",{},()=>[n.overflow&&n.options.updownButtonSpaceholder?(e.openBlock(),e.createElementBlock("div",Le)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.items,(o,w)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:w},[o.hidden!==!0&&o.divided==="up"?(e.openBlock(),e.createBlock(l,{key:0})):e.createCommentVNode("",!0),o.hidden!==!0&&o.divided==="self"?(e.openBlock(),e.createBlock(l,{key:1})):(e.openBlock(),e.createBlock(p,{key:2,clickHandler:o.onClick?I=>o.onClick(I):void 0,disabled:o.disabled,hidden:o.hidden,icon:o.icon,iconFontClass:o.iconFontClass,svgIcon:o.svgIcon,svgProps:o.svgProps,label:o.label,customRender:o.customRender,customClass:o.customClass,checked:o.checked,shortcut:o.shortcut,clickClose:o.clickClose,clickableWhenHasChildren:o.clickableWhenHasChildren,preserveIconWidth:o.preserveIconWidth!==void 0?o.preserveIconWidth:n.options.preserveIconWidth,showRightArrow:o.children&&o.children.length>0,hasChildren:o.children&&o.children.length>0,rawMenuItem:o,onSubMenuOpen:o.onSubMenuOpen,onSubMenuClose:o.onSubMenuClose},e.createSlots({_:2},[o.children&&o.children.length>0?{name:"submenu",fn:e.withCtx(()=>[e.createVNode(x,{items:o.children,maxWidth:o.maxWidth,minWidth:o.minWidth,adjustPosition:o.adjustSubMenuPosition!==void 0?o.adjustSubMenuPosition:n.options.adjustPosition,direction:o.direction!==void 0?o.direction:n.options.direction},null,8,["items","maxWidth","minWidth","adjustPosition","direction"])]),key:"0"}:void 0]),1032,["clickHandler","disabled","hidden","icon","iconFontClass","svgIcon","svgProps","label","customRender","customClass","checked","shortcut","clickClose","clickableWhenHasChildren","preserveIconWidth","showRightArrow","hasChildren","rawMenuItem","onSubMenuOpen","onSubMenuClose"])),o.hidden!==!0&&(o.divided==="down"||o.divided===!0)?(e.openBlock(),e.createBlock(l,{key:3})):e.createCommentVNode("",!0)],64))),128)),n.overflow&&n.options.updownButtonSpaceholder?(e.openBlock(),e.createElementBlock("div",Te)):e.createCommentVNode("",!0)])],4),e.createElementVNode("div",De,[e.withDirectives(e.createElementVNode("div",{ref:"upScrollButton",class:e.normalizeClass("mx-context-menu-updown mx-context-no-clickable up"+(n.overflow&&n.scrollValue<0?"":" disabled")),onClick:t[0]||(t[0]=o=>n.onScroll(!1)),onWheel:t[1]||(t[1]=(...o)=>n.onMouseWhellMx&&n.onMouseWhellMx(...o))},[e.createVNode(k)],34),[[e.vShow,n.overflow]]),e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass("mx-context-menu-updown mx-context-no-clickable down"+(n.overflow&&n.scrollValue>-n.scrollHeight?"":" disabled")),onClick:t[2]||(t[2]=o=>n.onScroll(!0)),onWheel:t[3]||(t[3]=(...o)=>n.onMouseWhellMx&&n.onMouseWhellMx(...o))},[e.createVNode(k)],34),[[e.vShow,n.overflow]])],512)],38)}const q=K(He,[["render",ze]]),Ke={class:"mx-menu-ghost-host"},de=e.defineComponent({__name:"ContextSubMenuWrapper",props:{options:{type:Object,default:null},show:{type:Object,default:null},container:{type:Object,default:null},isFullScreenContainer:{type:Boolean,default:!0}},emits:["close","closeAnimFinished"],setup(n,{expose:t,emit:s}){const a=n,h=s,C=e.useSlots(),{options:l,show:x,container:p}=e.toRefs(a);e.onMounted(()=>{x.value&&w()}),e.onBeforeUnmount(()=>{M()}),e.watch(x,d=>{d?w():(re(k),M())});const k={closeMenu:I,isClosed:P};let o=!1;function w(){_(),ge(k)}function I(d){o=!0,h("close",d),l.value.menuTransitionProps||h("closeAnimFinished"),re(k)}function P(){return o}function _(){setTimeout(()=>{document.addEventListener("click",m,!0),document.addEventListener("contextmenu",m,!0),document.addEventListener("scroll",u,!0),!a.isFullScreenContainer&&p.value&&p.value.addEventListener("scroll",u,!0),l.value.keyboardControl!==!1&&document.addEventListener("keydown",c)},50)}function M(){document.removeEventListener("contextmenu",m,!0),document.removeEventListener("click",m,!0),document.removeEventListener("scroll",u,!0),!a.isFullScreenContainer&&p.value&&p.value.removeEventListener("scroll",u,!0),l.value.keyboardControl!==!1&&document.removeEventListener("keydown",c)}const i=e.ref();e.provide("globalSetCurrentSubMenu",d=>i.value=d);function c(d){var y,O,F,$,W,g,E,T,A,S,D,r,f;let B=!0;switch(d.key){case"Escape":{((y=i.value)==null?void 0:y.isTopLevel())===!1?(O=i.value)==null||O.closeCurrentSubMenu():I();break}case"ArrowDown":(F=i.value)==null||F.moveCurrentItemDown();break;case"ArrowUp":($=i.value)==null||$.moveCurrentItemUp();break;case"Home":(W=i.value)==null||W.moveCurrentItemFirst();break;case"End":(g=i.value)==null||g.moveCurrentItemLast();break;case"ArrowLeft":{(E=i.value)!=null&&E.closeSelfAndActiveParent()||(A=(T=l.value).onKeyFocusMoveLeft)==null||A.call(T);break}case"ArrowRight":(S=i.value)!=null&&S.openCurrentItemSubMenu()||(r=(D=l.value).onKeyFocusMoveRight)==null||r.call(D);break;case"Enter":(f=i.value)==null||f.triggerCurrentItemClick(d);break;default:B=!1;break}B&&i.value&&(d.stopPropagation(),d.preventDefault())}function u(){l.value.closeWhenScroll!==!1&&I()}function m(d){b(d.target,d)}function b(d,B){var y,O;for(;d;){if(d.classList&&d.classList.contains("mx-menu-host"))return;d=d.parentNode}l.value.clickCloseOnOutside!==!1?(M(),I()):(O=(y=l.value).onClickOnOutside)==null||O.call(y,B)}return e.provide("globalOptions",l),e.provide("globalCloseMenu",I),e.provide("globalIsFullScreenContainer",a.isFullScreenContainer),e.provide("globalHasSlot",d=>C[d]!==void 0),e.provide("globalRenderSlot",(d,B)=>e.renderSlot(C,d,{...B},()=>[e.h("span","Render slot failed")],!1)),e.provide("menuContext",{zIndex:l.value.zIndex||R.defaultZindex,container:p.value,adjustPadding:{x:0,y:0},getParentAbsY:()=>l.value.x,getParentAbsX:()=>l.value.y,getZoom:()=>l.value.zoom||R.defaultZoom,getParentX:()=>0,getParentY:()=>0,getParentWidth:()=>0,getParentHeight:()=>0,getPositon:()=>[l.value.x,l.value.y],closeOtherSubMenuWithTimeOut:()=>{},checkCloseOtherSubMenuTimeOut:()=>!1,addOpenedSubMenu:()=>{},closeOtherSubMenu:()=>{},getParentContext:()=>null,getSubMenuInstanceContext:()=>null,getElement:()=>null,addChildMenuItem:()=>{},removeChildMenuItem:()=>{},markActiveMenuItem:()=>{},markThisOpenedByKeyBoard:()=>{},isOpenedByKeyBoardFlag:()=>!1,isMenuItemDataCollectedFlag:()=>!1}),t(k),(d,B)=>(e.openBlock(),e.createElementBlock("div",Ke,[e.unref(l).menuTransitionProps?(e.openBlock(),e.createBlock(e.Transition,e.mergeProps({key:0,appear:""},e.unref(l).menuTransitionProps,{onAfterLeave:B[0]||(B[0]=y=>h("closeAnimFinished"))}),{default:e.withCtx(()=>[e.unref(x)?(e.openBlock(),e.createBlock(q,{key:0,class:"mx-menu-host",items:e.unref(l).items,adjustPosition:e.unref(l).adjustPosition,maxWidth:e.unref(l).maxWidth||e.unref(R).defaultMaxWidth,minWidth:e.unref(l).minWidth||e.unref(R).defaultMinWidth,direction:e.unref(l).direction||e.unref(R).defaultDirection},{default:e.withCtx(()=>[e.renderSlot(d.$slots,"default")]),_:3},8,["items","adjustPosition","maxWidth","minWidth","direction"])):e.createCommentVNode("",!0)]),_:3},16)):e.unref(x)?(e.openBlock(),e.createBlock(q,{key:1,class:"mx-menu-host",items:e.unref(l).items,adjustPosition:e.unref(l).adjustPosition,maxWidth:e.unref(l).maxWidth||e.unref(R).defaultMaxWidth,minWidth:e.unref(l).minWidth||e.unref(R).defaultMinWidth,direction:e.unref(l).direction||e.unref(R).defaultDirection},{default:e.withCtx(()=>[e.renderSlot(d.$slots,"default")]),_:3},8,["items","adjustPosition","maxWidth","minWidth","direction"])):e.createCommentVNode("",!0)]))}}),an="",ue=e.defineComponent({name:"ContextMenu",emits:["update:show","close"],props:{options:{type:Object,default:null},show:{type:Boolean,default:!1}},setup(n,t){const{options:s,show:a}=e.toRefs(n);return t.expose({closeMenu:()=>t.emit("update:show",!1),isClosed:()=>!a.value}),()=>{const{isNew:h,container:C,eleId:l}=ae(s.value);return[e.h(e.Teleport,{to:`#${l}`},[e.h(de,{options:s,show:a,container:C,isFullScreenContainer:!h,onClose:x=>{var p,k;t.emit("update:show",!1),t.emit("close"),(k=(p=s.value).onClose)==null||k.call(p,x)}},t.slots)])]}}}),fe=e.defineComponent({name:"ContextMenuGroup",props:{disabled:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1},clickHandler:{type:Function,default:null},label:{type:String,default:""},icon:{type:String,default:""},iconFontClass:{type:String,default:"iconfont"},checked:{type:Boolean,default:!1},shortcut:{type:String,default:""},svgIcon:{type:String,default:""},svgProps:{type:Object,default:null},preserveIconWidth:{type:Boolean,default:!0},showRightArrow:{type:Boolean,default:!1},clickClose:{type:Boolean,default:!0},adjustSubMenuPosition:{type:Boolean,default:void 0},maxWidth:{type:[String,Number],default:0},minWidth:{type:[String,Number],default:0}},setup(n,t){const s=e.inject("globalOptions"),{adjustSubMenuPosition:a,maxWidth:h,minWidth:C}=e.toRefs(n),l=typeof a.value<"u"?a.value:s.value.adjustPosition;return()=>e.h(X,{...n,showRightArrow:!0,maxWidth:void 0,minWidth:void 0,adjustSubMenuPosition:void 0,hasChildren:typeof t.slots.default!==void 0},t.slots.default?{submenu:()=>e.h(q,{maxWidth:h.value,minWidth:C.value,adjustPosition:l},{default:t.slots.default})}:void 0)}});function Ye(n,t,s,a){const h=e.ref(!0),C=e.h(de,{options:n,show:h,container:t,isFullScreenContainer:!s,onCloseAnimFinished:()=>{e.render(null,t)},onClose:l=>{var x;(x=n.onClose)==null||x.call(n,l),h.value=!1}},a);return e.render(C,t),C.component}function me(n,t){const s=ae(n);return Ye(n,s.container,s.isNew,t).exposed}const ne={install(n){n.config.globalProperties.$contextmenu=me,n.component("ContextMenu",ue),n.component("ContextMenuItem",X),n.component("ContextMenuGroup",fe),n.component("ContextMenuSperator",G),n.component("ContextMenuSeparator",G),n.component("ContextSubMenu",q)},showContextMenu(n,t){return me(n,t)},isAnyContextMenuOpen(){return ke()},closeContextMenu:ie,transformMenuPosition:be},Ze={},Ue={class:"mx-menu-bar-icon-menu",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200"},Xe=[e.createElementVNode("path",{d:"M133.310936 296.552327l757.206115 0c19.781623 0 35.950949-16.169326 35.950949-35.950949 0-19.781623-15.997312-35.950949-35.950949-35.950949L133.310936 224.650428c-19.781623 0-35.950949 16.169326-35.950949 35.950949C97.359987 280.383 113.529313 296.552327 133.310936 296.552327z"},null,-1),e.createElementVNode("path",{d:"M890.51705 476.135058 133.310936 476.135058c-19.781623 0-35.950949 16.169326-35.950949 35.950949 0 19.781623 16.169326 35.950949 35.950949 35.950949l757.206115 0c19.781623 0 35.950949-16.169326 35.950949-35.950949C926.467999 492.304384 910.298673 476.135058 890.51705 476.135058z"},null,-1),e.createElementVNode("path",{d:"M890.51705 727.447673 133.310936 727.447673c-19.781623 0-35.950949 15.997312-35.950949 35.950949s16.169326 35.950949 35.950949 35.950949l757.206115 0c19.781623 0 35.950949-15.997312 35.950949-35.950949S910.298673 727.447673 890.51705 727.447673z"},null,-1)];function Ge(n,t){return e.openBlock(),e.createElementBlock("svg",Ue,Xe)}const qe=K(Ze,[["render",Ge]]),Je=["onClick","onMouseenter"],Qe=e.defineComponent({__name:"MenuBar",props:{options:{type:Object,default:null}},setup(n){const t=n,s=e.ref(),a=e.ref(!1),h=e.ref([]),C=e.ref(null);function l(){a.value=!0}function x(){a.value=!1}e.onMounted(()=>{h.value=t.options.items||[]}),e.watch(()=>t.options,()=>{h.value=t.options.items||[]});let p=null,k=-1;function o(){k<h.value.length-1?k++:k=0,P(k,h.value[k])}function w(){k>0?k--:k=h.value.length-1,P(k,h.value[k])}function I(c){const u=t.options.barPopDirection??"bl";let m=0,b=0;return u.startsWith("b")?b=H(c)+c.offsetHeight:u.startsWith("t")?b=H(c):b=H(c)+c.offsetHeight/2,u.endsWith("l")?m=L(c):u.startsWith("r")?m=L(c)+c.offsetWidth:m=L(c)+c.offsetWidth/2,{x:m,y:b}}function P(c,u){var b;if(k=c,!u.children)return;p&&(p.closeMenu(),p=null,a.value=!0),C.value=u;const m=(b=s.value)==null?void 0:b.children[c];if(m){const{x:d,y:B}=I(m);p=ne.showContextMenu({...t.options,items:u.children,x:d,y:B,onKeyFocusMoveLeft(){w()},onKeyFocusMoveRight(){o()},onClose(){C.value==u&&(a.value=!1,C.value=null)}})}}function _(){k=0;const c=s.value;if(c){const{x:u,y:m}=I(c);p=ne.showContextMenu({...t.options,x:u,y:m})}}function M(c,u){u?(a.value=!0,P(c,u),u.onClick&&(u.clickableWhenHasChildren===!0&&u.children&&u.children.length>0||!u.children||u.children.length===0)&&u.onClick()):_()}function i(c,u){a.value&&P(c,u)}return(c,u)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["mx-menu-bar",n.options.theme??"",n.options.mini?"mini":""]),onFocus:l,onBlur:x},[e.renderSlot(c.$slots,"prefix"),n.options.mini?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"menuBarContent",ref:s,class:"mx-menu-bar-content"},[e.createElementVNode("div",{class:"mx-menu-bar-item",onClick:u[0]||(u[0]=m=>M(0,null))},[e.createVNode(qe)])],512)):(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"menuBarContent",ref:s,class:"mx-menu-bar-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,(m,b)=>(e.openBlock(),e.createElementBlock("div",{key:b,class:e.normalizeClass(["mx-menu-bar-item",m==C.value?"active":""]),onClick:d=>M(b,m),onMouseenter:d=>i(b,m)},e.toDisplayString(m.label),43,Je))),128))],512)),e.renderSlot(c.$slots,"suffix")],34))}}),fn="";N.ContextMenu=ue,N.ContextMenuGroup=fe,N.ContextMenuItem=X,N.ContextMenuSeparator=G,N.MenuBar=Qe,N.default=ne,Object.defineProperties(N,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});