{"title":"$:/plugins/oeyoews/neotw-copy-code","description":"Neotw Copy Code","author":"oeyoews","version":"0.0.2","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"Neotw Copy Code","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus $:/plugins/oeyoews/neotw-icons","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-copy-code/Layout\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/Layout\",\"tags\":\"$:/tags/Layout\",\"name\":\"{{$:/plugins/oeyoews/neotw-copy-code/icon}} Neotw Copy Code\",\"description\":\"{{$:/plugins/oeyoews/neotw-copy-code/readme!!description}}\",\"text\":\"\\\\import [[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\\n\\n<$vars\\n  tv-config-toolbar-icons={{$:/config/Toolbar/Icons}}\\n  tv-config-toolbar-text={{$:/config/Toolbar/Text}}\\n  tv-config-toolbar-class={{$:/config/Toolbar/ButtonClass}}\\n  tv-enable-drag-and-drop={{$:/config/DragAndDrop/Enable}}\\n  tv-show-missing-links={{$:/config/MissingLinks}}\\n  storyviewTitle={{$:/view}}\\n  languageTitle={{{ [{$:/language}get[name]] }}}>\\n\\n<div class=\\\"prose max-w-none prose-indigo m-auto sm:w-auto md:w-2/3\\\">\\n{{{ [[$:/plugins/oeyoews/neotw-copy-code/readme]] ||$:/core/ui/ViewTemplate }}}\\n</div>\"},\"$:/plugins/oeyoews/neotw-copy-code/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/readme\",\"description\":\"~Copy Code\",\"text\":\"<div class=\\\"prose max-w-none prose-indigo\\\">\\n\\n!! Neotw Copy Code\\n\\nThis plugin is designed to add a copy code button to code blocks in TiddlyWiki, making it easier to copy code snippets with their formatting and indentation intact. In TiddlyWiki, code blocks are typically wrapped in the `<pre>` tag to preserve their formatting and indentation. However, copying the code manually can be inconvenient.\\n\\n> è¿™ä¸ªæ’ä»¶çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†åœ¨ TiddlyWiki ä¸­çš„ä»£ç å—ä¸­æ·»åŠ ä¸€ä¸ªå¤åˆ¶ä»£ç æŒ‰é’®ï¼Œä½¿å¾—å¤åˆ¶ä»£ç ç‰‡æ®µæ—¶èƒ½å¤Ÿä¿ç•™å…¶æ ¼å¼å’Œç¼©è¿›ã€‚åœ¨ TiddlyWiki ä¸­ï¼Œä»£ç å—é€šå¸¸ä¼šè¢«åŒ…è£¹åœ¨ `<pre>` æ ‡ç­¾ä¸­ï¼Œä»¥ä¿ç•™å…¶æ ¼å¼å’Œç¼©è¿›ã€‚ä½†æ˜¯ï¼Œæ‰‹åŠ¨å¤åˆ¶ä»£ç æ—¶ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚\\n\\nThis plugin solves this problem by adding a â€œCopy Codeâ€ button next to the code block. Clicking the button copies the code to the clipboard, and the copied code is also displayed in a popup using the SweetAlert2 plugin, making it easy to verify that the code was copied successfully.\\n> è¿™ä¸ªæ’ä»¶é€šè¿‡åœ¨ä»£ç å—æ—è¾¹æ·»åŠ ä¸€ä¸ªâ€œå¤åˆ¶ä»£ç â€æŒ‰é’®æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç‚¹å‡»æŒ‰é’®åï¼Œä»£ç ä¼šè¢«å¤åˆ¶åˆ°å‰ªè´´æ¿ä¸­ï¼Œå¹¶ä¸”å¤åˆ¶çš„ä»£ç ä¹Ÿä¼šä½¿ç”¨ SweetAlert2 æ’ä»¶åœ¨å¼¹å‡ºçª—å£ä¸­æ˜¾ç¤ºï¼Œæ–¹ä¾¿éªŒè¯ä»£ç æ˜¯å¦å¤åˆ¶æˆåŠŸã€‚\\n\\nThis plugin can greatly improve the efficiency and convenience of displaying and sharing code in TiddlyWiki, especially when you need to copy code frequently.\\n> è¿™ä¸ªæ’ä»¶å¯ä»¥æå¤§åœ°æé«˜åœ¨ TiddlyWiki ä¸­æ˜¾ç¤ºå’Œåˆ†äº«ä»£ç çš„æ•ˆç‡å’Œä¾¿åˆ©æ€§ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦é¢‘ç¹å¤åˆ¶ä»£ç æ—¶ã€‚\\n\\nThe only downside at the moment is that the copy button needs to be manually triggered for display.\\n> ç›®å‰å”¯ä¸€çš„ç¼ºç‚¹æ˜¯å¤åˆ¶æŒ‰é’®éœ€è¦æ‰‹åŠ¨è§¦å‘æ‰ä¼šæ˜¾ç¤ºã€‚\\n\\n!! Example\\n\\n<$button message=\\\"om-copy-code\\\" >\\n{{$:/plugins/oeyoews/neotw-copy-code/icon}} Click to show copy code button\\n</$button>\\n\\n```python\\n# Hello World program in Python\\nprint(\\\"Hello, World!\\\")\\n```\\n\\n```java\\n// Hello World program in Java\\npublic class HelloWorld {\\n    public static void main(String[] args) {\\n        System.out.println(\\\"Hello, World!\\\");\\n    }\\n}\\n```\\n\\n```javascript\\n// Hello World program in JavaScript\\nconsole.log(\\\"Hello, World!\\\");\\n```\\n\\n```c\\n/* Hello World program in C */\\n#include <stdio.h>\\nint main() {\\n    printf(\\\"Hello, World!\\\");\\n    return 0;\\n}\\n```\\n\\n```cpp\\n// Hello World program in C++\\n#include <iostream>\\nint main() {\\n    std::cout << \\\"Hello, World!\\\";\\n    return 0;\\n}\\n```\\n\\n```ruby\\n# Hello World program in Ruby\\nputs \\\"Hello, World!\\\"\\n```\\n\\n```php\\n<?php\\n// Hello World program in PHP\\necho \\\"Hello, World!\\\";\\n?>\\n```\\n\\n```swift\\n// Hello World program in Swift\\nprint(\\\"Hello, World!\\\")\\n```\\n\\n```go\\n// Hello World program in Go\\npackage main\\nimport \\\"fmt\\\"\\nfunc main() {\\n    fmt.Println(\\\"Hello, World!\\\")\\n}\\n```\\n\\n```kotlin\\n// Hello World program in Kotlin\\nfun main() {\\n    println(\\\"Hello, World!\\\")\\n}\\n```\\n\\n!! TODO\\n\\n<!-- * update copied icon -->\\n<!-- * add viewtoolbar not pagecontrol -->\\n<!-- * support hover scroll for code preview -->\\n<!-- * update style for button -->\\n<!-- * add hover style -->\\n* make preview is optional\\n* highlight plugin widget code ???\\n* add transform style\\n* update plugin dependencies\\n* float right modify too long code view when hover\\n\\n* copy code to image\\n* support copy image to clipboard\\n\\n!! Performace\\n\\n* lazy load button\\n\\n</div>\\n\"},\"$:/plugins/oeyoews/neotw-copy-code/add-copybutton.js\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/add-copybutton.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-copy-code/add-copybutton.js\\ntype: application/javascript\\nmodule-type: library\\n\\neotw-copy-code widget\\n\\\\*/\\n\\n// TODO: æ”¯æŒfiletype iconify\\n\\n// ä¸é€‚åˆ\\n/* function copybuttonListener() {\\n  document.addEventListener('mouseenter', () => {\\n    const codeBlocks = document.querySelectorAll('pre');\\n    codeBlocks.forEach(codeBlock => {\\n      codeBlock.addEventListener('mouseenter', () => {\\n        addCopyButton();\\n      });\\n    });\\n  });\\n} */\\n\\nmodule.exports = function addCopyButton() {\\n  // æ‰¾åˆ°å½“å‰é¡µé¢çš„æ‰€æœ‰ä»£ç å—\\n  const codeBlocks = document.querySelectorAll('pre');\\n\\n  Swal.fire({\\n    title: codeBlocks.length ? `Enable copy code` : `å½“å‰é¡µé¢æ²¡æœ‰å‘ç°ä»£ç å—`,\\n    icon: codeBlocks.length ? 'success' : 'info',\\n    toast: true,\\n    showCancelButton: false,\\n    showConfirmButton: false,\\n    timer: 1500,\\n    position: 'top-end',\\n  });\\n\\n  // å¦‚æœæ²¡æœ‰ä»£ç å—, ç»“æŸ\\n  if (!codeBlocks.length) {\\n    return;\\n  }\\n\\n  codeBlocks.forEach((codeBlock) => {\\n    // codeBlock.addEventListener('mouseenter', () => {\\n    //   console.log('updated');\\n    // });\\n    // æŸ¥æ‰¾ copybutton æŒ‰é’®\\n    const existingButton = codeBlock.querySelector('.copy-button');\\n    // å¦‚æœå·²ç»æ·»åŠ è¿‡copybutton, ç»“æŸ\\n    if (existingButton) return;\\n\\n    // TODO: not work\\n    // å¦‚æœä»£ç ä¸ºç©º, ä¸æ·»åŠ  copybutton æŒ‰é’®\\n    const codeElement = codeBlock.querySelector('code');\\n    if (!codeElement) return;\\n\\n    // support group with tailwindcss\\n    codeBlock.classList.add('group');\\n\\n    // è·å– code è¯­è¨€ç±»å‹\\n    const fileType = codeElement.className.match(/language-(\\\\w+)/)?.[1] || '';\\n    // opacity-0 scale-0 group-hover:opacity-100 group-hover:scale-100\\n    classNames =\\n      'copy-button delay-200 float-right hover:bg-gray-200 transition-all duration-800 ease-in-out p-2 flex flex-row';\\n\\n    // æ·»åŠ  copybutton\\n    const copyButton = $tw.utils.domMaker('button', {\\n      text: fileType ? `${fileType}` : 'copy',\\n      class: fileType ? classNames : classNames + ' -m-4',\\n    });\\n\\n    const fileIcon = document.createElement('iconify-icon');\\n    fileIcon.setAttribute('icon', `mdi:language-${fileType}`);\\n    fileIcon.classList.add('mx-1');\\n    if (fileType) {\\n      copyButton.appendChild(fileIcon);\\n    }\\n\\n    const notify = () => {\\n      Swal.fire({\\n        title: `Copied to clipboard`,\\n        icon: 'success',\\n        toast: true,\\n        showCancelButton: false,\\n        showConfirmButton: false,\\n        timer: 1500,\\n        position: 'top-end',\\n      });\\n    };\\n\\n    copyButton.addEventListener('click', () => {\\n      // TODO: add click sound\\n      // copy to clipboard\\n\\n      // NOTE: 0.0.0.0:xxx å¯èƒ½è‡ªåŠ¨ç¦ç”¨clipboard\\n      // IOS å¹¶ä¸æ”¯æŒnavigator, ç›®å‰ä¸æ‰“æ–­å†™å…¼å®¹ä»£ç \\n      navigator?.clipboard\\n        ?.writeText(codeElement.textContent)\\n        .then(() => {\\n          if (typeof Swal?.fire === 'function') {\\n            notify();\\n          } else {\\n            copyButton.textContent = 'âœ… Copied!';\\n            setTimeout(() => {\\n              copyButton.textContent = fileType ? `${fileType} ğŸ“‹` : 'ğŸ“‹';\\n            }, 1000);\\n          }\\n        })\\n        .catch((err) => {\\n          console.log(err);\\n        });\\n    });\\n\\n    codeElement?.parentNode?.insertBefore(copyButton, codeElement);\\n  });\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-copy-code/copycode-startup.js\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/copycode-startup.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-copy-code/copycode-startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\ncopyButton module\\n\\n\\\\*/\\n(function () {\\n  /*jslint node: true, browser: true */\\n  /*global $tw: false */\\n  'use strict';\\n\\n  exports.name = 'copyButton-startup-hook';\\n  exports.platforms = ['browser'];\\n  exports.after = ['startup'];\\n  exports.synchronous = true;\\n  exports.startup = () => {\\n    const addCopyButton = require('$:/plugins/oeyoews/neotw-copy-code/add-copybutton.js');\\n    $tw.rootWidget.addEventListener('om-copy-code', () => {\\n      addCopyButton();\\n    });\\n  };\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/oeyoews/neotw-copy-code/icon\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/icon\",\"text\":\"<svg stroke=\\\"currentColor\\\" fill=\\\"currentColor\\\" stroke-width=\\\"0\\\" viewBox=\\\"0 0 24 24\\\" height=\\\"1em\\\" width=\\\"1em\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path fill=\\\"none\\\" d=\\\"M0 0h24v24H0z\\\"></path><path d=\\\"M18 2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H9V4h9v12zM3 15v-2h2v2H3zm0-5.5h2v2H3v-2zM10 20h2v2h-2v-2zm-7-1.5v-2h2v2H3zM5 22c-1.1 0-2-.9-2-2h2v2zm3.5 0h-2v-2h2v2zm5 0v-2h2c0 1.1-.9 2-2 2zM5 6v2H3c0-1.1.9-2 2-2z\\\"></path></svg>\"},\"$:/plugins/oeyoews/neotw-copy-code/snippets/neotw-copy-code\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/snippets/neotw-copy-code\",\"caption\":\"neotw-copy-code Widget\",\"description\":\"Neotw Copy Code Widget\",\"tags\":\"$:/tags/TextEditor/Snippet\"},\"$:/plugins/oeyoews/neotw-copy-code/ui\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/ui\",\"tags\":\"$:/tags/PageControls\",\"list-before\":\"\",\"description\":\"copy code button\",\"caption\":\"Copy Button\",\"text\":\"\\\\whitespace trim\\n<$button message=\\\"om-copy-code\\\" tooltip=\\\"Copy Code\\\" aria-label=\\\"copy\\\" class=<<tv-config-toolbar-class>>>\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n{{$:/plugins/oeyoews/neotw-copy-code/icon}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\">\\n<$text text=\\\"Copy\\\"/>\\n</span>\\n</$list>\\n</$button>\\n\"}}}"}