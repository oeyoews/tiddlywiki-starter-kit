{"title":"$:/plugins/oeyoews/neotw-notion-gallery","description":"neotw-notion-gallery","author":"oeyoews","version":"0.0.6","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"neotw-notion-gallery","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-notion-gallery/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/readme\",\"description\":\"å¡ç‰‡è§†å›¾\",\"text\":\"!! ä½¿ç”¨æ–¹æ³•\\n\\n```bash\\n<$cards />\\n\\n## å¯é€‰å‚æ•°filter, filter é»˜è®¤ä¸º [!is[system]!has[draft.of]!sort[created]limit[9]]\\n<$cards filter=\\\"[tag[Journal]limit[9]]\\\"/>\\n\\n## æŒ‡å®šæŸä¸€ä¸ª(æˆ–è€…å¤šä¸ª)å›ºå®štiddler\\n<$cards filter=\\\"[[$:/core/ui/ControlPanel/Plugins]] [[GettingStarted]]\\\" />\\n\\n## æ‚åˆ(æ··ç”¨)\\n## tiddler çš„ç­›é€‰å™¨ç”¨æ³•æ²¡æœ‰æ˜ç¡®çš„æœ¯è¯­è¡¨è¾¾,å¯¼è‡´æ•™ç¨‹åªèƒ½`show me the code`, ä¸åƒå¤§ä¼—åŒ–çš„ç¼–ç¨‹è¯­è¨€(æ¯”å¦‚JS,React,Vue),å®˜æ–¹ç»Ÿä¸€åˆ¶å®šäº†æœ¯è¯­, æ¯”è¾ƒæµ…æ˜¾æ˜“æ‡‚\\n<$cards filter=\\\"[[GettingStarted]] [!is[system]!has[draft.of]!sort[modified]!is[shadow]limit[8]]\\\" />\\n```\\n\\n> å›¾ç‰‡é»˜è®¤ä½¿ç”¨æ¯ä¸ªtiddlerçš„page-coverå­—æ®µ, å¦‚æœpage-coverå­—æ®µä¸å­˜åœ¨, åˆ™ä½¿ç”¨ `https://source.unsplash.com/random/1920x1080?fm=blurhash&${title}`\\n\\n> ä¾èµ–æ’ä»¶: tailwindcss\\n\\n> é»˜è®¤ä½¿ç”¨(16:9)1920x1080çš„åˆ†è¾¨ç‡(åˆ†è¾¨ç‡è¶Šå¤§, å›¾ç‰‡åŠ è½½é€Ÿåº¦å°±ç›¸å¯¹è¾ƒæ…¢)\\n\\n> å·²ç»å€ŸåŠ©tailwindcsså¯¹é¡µé¢è¿›è¡Œäº†é˜²æŠ–åŠ¨å¤„ç†, å›¾ç‰‡æ¨¡ç³ŠåŠ è½½, å›¾ç‰‡æ¥æºè‡ªunsplash\\n\\n> ä¹‹æ‰€ä»¥ç›®å‰ä»…ä»…æ˜¾ç¤ºå›¾ç‰‡, è€Œä¸æ˜¯åƒnotionçš„galleryå¸ƒå±€, æ˜¯å› ä¸ºç”±äºfilterçš„ä¸åŒä¼šå¯¼è‡´ä¸åŒçš„æ ·å¼, æ­¤æ’ä»¶ç›®å‰å¤„äºbetaé˜¶æ®µ, æš‚æ—¶ä¸æ‰“ç®—æ”¯æŒç±»ä¼¼notionçš„åŠ¨æ€å­—æ®µé…ç½®(æ—¶é—´æœ‰é™, ç†è®ºä¸Šæ˜¯å®Œå…¨å¯ä»¥åšåˆ°)\\n\\n!! Recipes\\n\\n> æ¯ä¸ªtiddlerçš„æ ‡é¢˜ä¸è¦åƒè®ºæ–‡æ ‡é¢˜é‚£æ ·è¿‡é•¿(ä¹Ÿè®¸æˆ‘æ­£æ–‡çš„éƒ¨åˆ†è¿˜æ²¡ä½ çš„æ ‡é¢˜é•¿ ğŸ˜€), å°½é‡ç®€çŸ­æ‰¼è¦\\n\\n!! æ˜¾ç¤ºæœ€è¿‘æ›´æ–°åŠ¨æ€\\n\\n<$cards />\\n\\n!! æœ€è¿‘çš„æ—¥å¿—\\n\\n<$cards filter=\\\"[tag[Journal]limit[9]]\\\"/>\\n\\n<!-- > å…¶å®ä½¿ç”¨wikitextå¯ä»¥å¾ˆå¿«å†™ä¸€ä¸ª, ä½†æ˜¯wikitextçš„enlist, set, var(ç”¨æ³•), æ¯æ¬¡éƒ½è®°ä¸ä½(æ–‡æ¡£æœç´¢çœŸçš„ä¸å¥½ç”¨), å¤´ç–¼ -->\\n<!-- ä¼šæœ‰é—ªçƒ, ç”±äºtailwindcssä¸ºåŠ è½½å®Œæˆåº”ç”¨æ ·å¼ -->\\n\\n<!-- äº‹å®è¯æ˜jså†™çš„widgetæ›´å…·æœ‰æ‰©å±•æ€§,çµæ´»æ€§ -->\\n\\n!! TODO\\n\\n1. add dynamic filter interface\\n\"},\"$:/plugins/oeyoews/neotw-notion-gallery/config.js\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/config.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-notion-gallery/config.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\nmodule.exports = {\\n  defaultFilter: '[!is[system]!has[draft.of]!sort[modified]limit[9]]',\\n  imageField: 'page-cover',\\n  // minCards: 9,\\n  maxCards: 30,\\n  resoultion: '1920x1080',\\n  imageSource: 'https://source.unsplash.com/random',\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-notion-gallery/createCard.js\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/createCard.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-notion-gallery/createCard.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\n/** create card */\\nmodule.exports = function createCard(title, cover, clickEvents) {\\n  const options = {\\n    root: null,\\n    rootMargin: '0px',\\n    threshold: 0.3, // å½“å›¾ç‰‡50%è¿›å…¥å¯è§†åŒºåŸŸæ—¶åŠ è½½\\n  };\\n\\n  function callback(entries, observer) {\\n    entries.forEach((entry) => {\\n      if (entry.isIntersecting) {\\n        const image = entry.target;\\n        image.src = cover;\\n        image.onload = () => {\\n          image.classList.remove(...dynamicClassNames);\\n          item.appendChild(h3);\\n        };\\n        observer.unobserve(image); // åŠ è½½åå–æ¶ˆç›‘æµ‹\\n      }\\n    });\\n  }\\n\\n  const observer = new IntersectionObserver(callback, options);\\n\\n  const item = document.createElement('div');\\n\\n  const navigate = clickEvents;\\n\\n  item.classList.add(\\n    'flex',\\n    'flex-col',\\n    'items-center',\\n    'justify-center',\\n    'group',\\n    'relative',\\n    'p-0',\\n  );\\n  const h3 = document.createElement('h3');\\n  h3.title = 'ç‚¹å‡»æŸ¥çœ‹';\\n  h3.classList.add(\\n    'delay-100',\\n    'text-lg',\\n    'cursor-pointer',\\n    'flex',\\n    'justify-center',\\n    'items-center',\\n    'truncate',\\n    'm-0',\\n    'inset-0',\\n    'absolute',\\n    'bg-black',\\n    'backdrop-blur',\\n    'bg-opacity-50',\\n    'text-white',\\n    'rounded-md',\\n    'scale-0',\\n    'ease-in-out',\\n    'transition-all',\\n    'group-hover:scale-105',\\n  );\\n  h3.textContent = title;\\n  h3.addEventListener('click', () => navigate(title));\\n  const img = document.createElement('img');\\n  // åŠ¨æ€åŠ è½½å›¾ç‰‡çš„æ•°é‡å–å†³äºè§†å›¾çš„å®½åº¦å’Œé«˜åº¦, ä¸æ˜¯å¯è§è§†å›¾\\n  img.loading = 'lazy';\\n  const dynamicClassNames = [\\n    'scale-105',\\n    'blur-lg',\\n    'bg-black/10',\\n    'cursor-wait',\\n  ];\\n  img.classList.add(\\n    'aspect-video',\\n    'object-cover',\\n    'w-full',\\n    'h-full',\\n    'rounded-md',\\n    'group-hover:scale-105',\\n    'transition-all',\\n    'duration-800',\\n    'ease-in-out',\\n    ...dynamicClassNames,\\n  );\\n\\n  img.alt = title;\\n  // img.src = 'favicon.ico';\\n  item.appendChild(img);\\n\\n  observer.observe(img);\\n\\n  return item;\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-notion-gallery/widget.js\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-notion-gallery/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nneotw-notion-gallery widget\\n\\n\\\\*/\\n(function () {\\n  /*jslint node: true, browser: true */\\n\\n  /*global $tw: false */\\n  'use strict';\\n\\n  const Widget = require('$:/core/modules/widgets/widget.js').widget;\\n  const createCard = require('./createCard');\\n  const config = require('./config');\\n\\n  class cardsWidget extends Widget {\\n    constructor(parseTreeNode, options) {\\n      super(parseTreeNode, options);\\n      this.maxCards = config.maxCards;\\n      this.defaultFilter = config.defaultFilter;\\n      this.tiddlersLength = null;\\n      // this.tiddlersLength = $tw.wiki.filterTiddlers(\\n      //   '[!is[system]!has[draft.of]]',\\n      // ).length;\\n    }\\n\\n    render(parent, nextSibling) {\\n      if (!$tw.browser) return;\\n      // check if tailwind is installed\\n      // need add window on browser\\n      if (!window.tailwind) {\\n        console.warn('tailwind not installed by @neotw-notion-gallery');\\n      }\\n\\n      this.parentDomNode = parent;\\n      this.computeAttributes();\\n      this.execute();\\n\\n      const wiki = $tw.wiki;\\n\\n      // éœ€è¦thisæŒ‡å‘parentWidget, ä½¿ç”¨ç®­å¤´å‡½æ•°\\n      const navigate = (title) => {\\n        this.parentWidget.dispatchEvent({\\n          type: 'tm-navigate',\\n          param: title,\\n          navigateTo: title,\\n        });\\n        return false;\\n      };\\n\\n      const { imageField, resoultion, imageSource } = config;\\n\\n      this.tiddlersLength = this.getFilterLength();\\n\\n      // TODO: æ”¯æŒfilter interface ui\\n      const filter = this.getAttribute('filter', this.defaultFilter);\\n      const recentTiddlers = wiki.filterTiddlers(filter);\\n\\n      const loadData = (tiddlers) => {\\n        return tiddlers.slice(0, this.maxCards).map((tiddler) => {\\n          const { fields } = wiki.getTiddler(tiddler);\\n          let cover = fields[imageField];\\n          if (!cover || !cover.startsWith('http')) {\\n            cover = `${imageSource}/${resoultion}?fm=blurhash&${fields.title}`;\\n          }\\n          return {\\n            title: fields.title,\\n            cover,\\n          };\\n        });\\n      };\\n\\n      const container = document.createElement('div');\\n      container.classList.add(\\n        'grid',\\n        'grid-cols-1',\\n        'sm:grid-cols-2',\\n        'md:grid-cols-3',\\n        'gap-8',\\n        'm-4',\\n      );\\n\\n      // TODO: åˆ†é¡µ\\n      if (recentTiddlers.length > this.maxCards) {\\n        console.warn(\\n          `${recentTiddlers.length} å¼ å¡ç‰‡å³å°†æ¸²æŸ“, è¶…è¿‡æœ€å¤§é™åˆ¶ ${this.maxCards}, ä»…æ¸²æŸ“å‰ä¸‰åå¼ å¡ç‰‡ @neotw-notion-gallery`,\\n        );\\n      }\\n\\n      const data = loadData(recentTiddlers);\\n\\n      data.forEach(({ title, cover }) => {\\n        container.appendChild(createCard(title, cover, navigate));\\n      });\\n\\n      parent.insertBefore(container, nextSibling);\\n      this.domNodes.push(container);\\n    }\\n\\n    removedNumberFilter(filter) {\\n      return filter.replace(/limit\\\\[\\\\d+\\\\]/g, '');\\n    }\\n\\n    getFilterLength() {\\n      return $tw.wiki.filterTiddlers(\\n        this.removedNumberFilter(this.defaultFilter),\\n      ).length;\\n    }\\n\\n    // å¦‚æœæ–°å¢æˆ–è€…åˆ é™¤tiddler, è¿›è¡Œé‡æ–°æ¸²æŸ“(é‡å‘½åä¸ä¼š)\\n    refresh() {\\n      let tiddlersLength = this.getFilterLength(); // è·å–æœ€æ–°å€¼\\n      if (tiddlersLength !== this.tiddlersLength) {\\n        this.refreshSelf(); // é‡æ–°æ¸²æŸ“\\n        this.tiddlersLength = tiddlersLength; // update tiddlers length\\n      }\\n    }\\n  }\\n\\n  exports.cards = cardsWidget;\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}