---
title: 'obj-clone'
tags: ['JavaScript']
type: 'text/markdown'
created: 'Mon May 22 2023 10:40:23 GMT+0000 (GMT)'
creator: 'oeyoews'
modifier: 'oeyoews'
qrcode: 'yes'
---

# obj-clone

:::abstract\

其实主要是引用类型，浅拷贝只能针对基本数据类型\

:::

我们可以通过生活中的例子来更加形象地理解深拷贝和浅拷贝。

假设你有一本书，书中有很多章节，每个章节有许多页，每页上有文字和图片。这本书就可以看作是一个对象，每个章节就是一个数组，每页就是一个对象，文字和图片就是属性值。

现在你想要把这本书借给你的朋友，但是你不想让朋友修改这本书的内容。如果你使用浅拷贝的方式，就相当于把这本书复制了一份，让你的朋友也可以看到这本书，但是你们两个人看到的是同一本书，如果你的朋友在书中做了标记或修改了内容，你也会看到这些标记和修改。

如果你使用深拷贝的方式，就相当于把这本书复制了一份，但是你和你的朋友看到的是两本不同的书，你朋友对他的那本书做了任何修改，都不会影响你看到的那本书。

另外，我们也可以举一个更加简单的例子来理解深拷贝和浅拷贝。假设你有一个盒子，里面放了一个苹果。如果你使用浅拷贝的方式，就相当于你把这个盒子复制了一份，但是两个盒子里面放的还是同一个苹果，如果你从一个盒子里取出苹果，另一个盒子里的苹果也会被取出。如果你使用深拷贝的方式，就相当于你把这个盒子复制了一份，但是两个盒子里面放的是两个完全一样的苹果，如果你从一个盒子里取出苹果，另一个盒子里的苹果还是在原地。

深拷贝（deep copy）和浅拷贝（shallow copy）是在 JavaScript 中经常用到的概念。

浅拷贝是指将一个对象的属性值复制到另一个对象，如果属性值是基本数据类型（如字符串、数字、布尔值等），则复制的是基本数据类型的值；如果属性值是引用数据类型（如数组、对象、函数等），则复制的是内存地址，也就是说两个对象会共享同一个引用类型的值。如果其中一个对象修改了这个引用类型的值，另一个对象也会受到影响。

深拷贝则是将一个对象的所有属性值都复制到另一个对象，包括基本数据类型和引用数据类型。即使原始对象中的引用类型属性值发生了改变，拷贝后的对象中的引用类型属性值也不会受到影响，因为它们指向的是不同的内存地址。

举个例子，如果我们有一个对象 obj1：

```javascript
const obj1 = {
  name: 'Alice',
  age: 18,
  hobbies: ['reading', 'dancing'],
  address: {
    city: 'Shanghai',
    street: 'Nanjing Road',
  },
};
```

那么浅拷贝 obj2 可以通过以下方式实现：

```javascript
const obj2 = Object.assign({}, obj1);
```

此时修改 obj1 的 hobbies 属性会影响 obj2：

```javascript
obj1.hobbies.push('swimming');
console.log(obj2.hobbies); // ['reading', 'dancing', 'swimming']
```

而深拷贝 obj3 可以通过以下方式实现：

```javascript
const obj3 = JSON.parse(JSON.stringify(obj1));
```

此时修改 obj1 的 hobbies 属性不会影响 obj3：

```javascript
obj1.hobbies.push('swimming');
console.log(obj3.hobbies); // ['reading', 'dancing']
```

需要注意的是，JSON.parse(JSON.stringify()) 这种方式虽然可以实现深拷贝，但是它有一些限制，例如无法拷贝函数、正则表达式等特殊对象。在实际开发中，需要根据具体情况选择合适的方式进行拷贝。

直接修改 `b` 对象和修改 `b` 对象里面的值是有区别的。

当你直接修改 `b` 对象时，意味着你对 `b` 进行了重新赋值或者指向了另一个对象。这将导致 `b` 引用的对象完全改变，与原始对象不再有任何关联。

而当你修改 `b` 对象里面的值时，即使你修改了 `b` 对象的属性值，但 `b` 仍然指向的是同一个对象。因此，如果其他地方有引用到 `b` 的地方也会受到影响。

```javascript
const sourceObj = {a: 1, b: {c: 2}};

// 直接修改 b 对象
sourceObj.b = {d: 3};
console.log(sourceObj); // {a: 1, b: {d: 3}}

// 修改 b 对象里面的值
sourceObj.b.c = 4;
console.log(sourceObj); // {a: 1, b: {c: 4}}
```

在第一个例子中，我们直接修改了 `sourceObj.b` 对象，将其重新赋值为 `{d: 3}`。这导致 `b` 引用的对象完全改变，与原始对象 `{c: 2}` 不再有任何关联。

在第二个例子中，我们修改了 `sourceObj.b.c` 的值，而 `b` 仍然指向的是同一个对象。所以，如果其他地方有引用到 `sourceObj.b` 的地方，它们也会看到这个修改。

因此，直接修改 `b` 对象会改变整个对象的结构，而修改 `b` 对象里面的值只是修改了对象内部的属性值。区别在于是否影响到其他引用了该对象的地方。
